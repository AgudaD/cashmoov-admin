<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        font-family: "Montserrat", sans-serif;
        margin: 0;
        overflow-x: hidden;
      }

      /* Hide Scrollbar */
      .hide-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      /* Sidebar */
      #sideNav {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: 16rem;
        z-index: 100;
      }

      /* Main Content */
      .main-content {
        margin-left: 16rem;
        padding: 2rem;
        overflow-x: auto;
        height: 100vh;
      }

      /* Table Container */
      .table-container {
        overflow-x: auto;
        max-width: 100%;
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 150;
        overflow-y: auto;
      }
      .modal-content {
        background: white;
        margin: 5% auto;
        padding: 20px;
        width: 90%;
        max-width: 500px;
        max-height: 80vh;
        overflow-y: auto;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      /* Action Button (used in Transactions, now for Billers/Categories too) */
      .actionBtn {
        background: none;
        border: none;
        cursor: pointer;
        color: #6b7280; /* Tailwind gray-500 */
        transition: color 0.2s ease;
      }
      .actionBtn:hover {
        color: #1f2937; /* Tailwind gray-800 */
      }

      /* Dropdown Menu (shared across all sections) */
      .dropdown-menu {
        display: none;
        position: absolute;
        background: red;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        z-index: 200;
        min-width: 120px;
      }
      .dropdown-menu button {
        display: block;
        width: 100%;
        text-align: left;
        padding: 8px 12px;
        background: none;
        border: none;
        font-size: 14px;
        color: #374151; /* Tailwind gray-700 */
        cursor: pointer;
        transition: background-color 0.2s ease;
      }
      .dropdown-menu button:hover {
        background: #f0f0f0; /* Light gray hover */
      }
      /* Existing .dropdown-menu styles are fine, no change needed */
      .action-menu {
        position: relative;
        display: inline-block;
      }

      .action-icon {
        cursor: pointer;
        font-size: 20px; /* Adjust size of the ellipsis */
        color: #6b7280; /* Tailwind gray-500 */
      }

      .action-icon:hover {
        color: #1f2937; /* Tailwind gray-800 */
      }
      .countries-table-container {
      max-height: 100rem;
      overflow-y: auto;
      position: relative;
    }
    .countries-table-container table {
      width: 100%;
      border-collapse: collapse;
    }
    .countries-table-container thead {
      position: sticky;
      top: 0;
      z-index: 10;
      background: #e5e7eb;
    }
    .dropdown-menu {
      min-width: 120px;
      border: 1px solid #e5e7eb;
    }
    .dropdown-menu button {
      display: block;
      width: 100%;
      text-align: left;
    }
    </style>
  </head>
  <body class="bg-gray-100 h-screen flex">
    <div
      id="sideNav"
      class="h-screen bg-[#12729C] text-white overflow-y-auto hide-scrollbar w-64 fixed"
    ></div>
    <div class="main-content flex-1">
      <h1 class="text-3xl font-bold mb-6">Management</h1>

      <!-- Tabs -->
      <div class="flex border-b mb-4">
        <button
          id="billsPaymentTab"
          class="px-4 py-2 font-semibold text-gray-700 border-b-2 border-blue-500"
        >
          Bills Payment
        </button>
        <button
          id="clientManagementTab"
          class="px-4 py-2 font-semibold text-gray-700"
        >
          Client Management
        </button>
        <button
          id="productManagementTab"
          class="px-4 py-2 font-semibold text-gray-700"
        >
          Product Management
        </button>
        <button
          id="userManagementTab"
          class="px-4 py-2 font-semibold text-gray-700"
        >
          User Management
        </button>
        <button
          id="countriesManagementTab"
          class="px-4 py-2 text-gray-600 hover:text-blue-500"
        >
          Countries Management
        </button>
      </div>

      <!-- Bills Payment Tab Content -->
      <div id="billsPaymentContent" class="tab-content">
        <h2 class="text-xl font-semibold mb-4">Bills Payment</h2>
        <div class="p-6">
          <div class="flex justify-between items-center mb-4">
            <!-- Left: Transactions Dropdown -->
            <div>
              <label
                for="billsPaymentDropdown"
                class="block text-sm font-medium text-gray-700"
                >Select Data</label
              >
              <select
                id="billsPaymentDropdown"
                class="mt-1 block w-48 p-3 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
              >
                <option value="transactions">Transactions</option>
                <option value="providers">Providers</option>
                <option value="categories">Categories</option>
                <option value="billers" selected>Billers</option>
                <option value="configuration">Configuration</option>
              </select>
            </div>
            <!-- Right: Filter, Retry Icons, and Add New Button -->
            <div class="flex items-center space-x-4">
              <div
                id="transactionsControls"
                class="flex items-center space-x-6 hidden"
              >
                <button
                  id="toggleFilterBtn"
                  class="text-gray-500 hover:text-gray-700 flex items-center gap-3"
                >
                  <p class="capitalize text-lg">filter</p>
                  <img
                    src="https://res.cloudinary.com/dgqyobxzg/image/upload/v1744191977/faders-icon_ydtv8d.png"
                    alt="filter transactions"
                    class="w-6 h-auto"
                  />
                </button>
                <button
                  id="retryFetchTransactions"
                  class="text-gray-500 hover:text-gray-700 flex items-center gap-3"
                >
                  <p class="capitalize text-lg">refresh</p>
                  <img
                    src="https://res.cloudinary.com/dgqyobxzg/image/upload/v1744191985/retry-icon_oyxvmc.png"
                    alt="refresh transactions"
                    class="w-6 h-auto"
                  />
                </button>
              </div>
              <button
                id="addBillsPaymentBtn"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white hover:bg-[#0f5c80] hidden"
              >
                Add New
              </button>
            </div>
          </div>
          <!-- New Transactions Tabs -->
          <div id="transactionsTabs" class="flex border-b mb-4 hidden">
            <button
              id="standardTab"
              class="px-4 py-2 font-semibold text-gray-700 border-b-2 border-blue-500"
            >
              Standard
            </button>
            <button
              id="detailedRemittanceTab"
              class="px-4 py-2 font-semibold text-gray-700"
            >
              Remittance
            </button>
          </div>

          <!-- Filter Form (Only for Transactions, Hidden by Default) -->
          <div id="transactionsFilterContainer" class="hidden mb-4">
            <form
              id="billsPaymentFilterForm"
              class="grid grid-cols-1 md:grid-cols-4 gap-4 bg-white p-4 rounded-md shadow-md"
            >
              <div>
                <label
                  for="categoryId"
                  class="block text-sm font-medium text-gray-700"
                  >Category Name</label
                >
                <input
                  type="text"
                  id="categoryId"
                  name="categoryName"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-0"
                />
              </div>
              <div>
                <label
                  for="providerName"
                  class="block text-sm font-medium text-gray-700"
                  >Provider Name</label
                >
                <input
                  type="text"
                  id="providerName"
                  name="providerName"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-0"
                />
              </div>
              <div>
                <label
                  for="agentMobileNumber"
                  class="block text-sm font-medium text-gray-700"
                  >Agent Mobile Number</label
                >
                <input
                  type="text"
                  id="agentMobileNumber"
                  name="agentMobileNumber"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-0"
                />
              </div>
              <div>
                <label
                  for="countryId"
                  class="block text-sm font-medium text-gray-700"
                  >Country Name</label
                >
                <input
                  type="text"
                  id="countryId"
                  name="countryName"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-0"
                />
              </div>
              <div>
                <label
                  for="workflowStatus"
                  class="block text-sm font-medium text-gray-700"
                  >Workflow Status</label
                >
                <select
                  id="workflowStatus"
                  name="status"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-0"
                >
                  <option value="">All</option>
                  <option value="PENDING">Pending</option>
                  <option value="COMPLETED">Completed</option>
                  <option value="FAILED">Failed</option>
                </select>
              </div>
              <div>
                <label
                  for="customerReference"
                  class="block text-sm font-medium text-gray-700"
                  >Customer Reference</label
                >
                <input
                  type="text"
                  id="customerReference"
                  name="customerReference"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-0"
                />
              </div>
              <div>
                <label
                  for="requestDate"
                  class="block text-sm font-medium text-gray-700"
                  >Request Date</label
                >
                <input
                  type="date"
                  id="requestDate"
                  name="requestDate"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-0"
                />
              </div>
              <div>
                <label
                  for="startDate"
                  class="block text-sm font-medium text-gray-700"
                  >Start Date</label
                >
                <input
                  type="date"
                  id="startDate"
                  name="startDate"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-0"
                />
              </div>
              <div>
                <label
                  for="endDate"
                  class="block text-sm font-medium text-gray-700"
                  >End Date</label
                >
                <input
                  type="date"
                  id="endDate"
                  name="endDate"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-0"
                />
              </div>
              <div class="flex items-end gap-2">
                <button
                  type="submit"
                  class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700"
                >
                  Filter
                </button>
                <button
                  type="button"
                  id="resetFilters"
                  class="w-full bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400"
                >
                  Reset
                </button>
              </div>
            </form>
          </div>

          <div
            id="billsPaymentList"
            class="mt-4 space-y-4 table-container"
          ></div>
          <div
            id="transactionsPagination"
            class="hidden mt-4 flex justify-between items-center"
          >
            <button
              id="prevTransactions"
              class="px-4 py-2 bg-gray-500 text-white rounded-md disabled:opacity-50"
              disabled
            >
              Previous
            </button>
            <span id="transactionsPageInfo" class="text-gray-700"></span>
            <button
              id="nextTransactions"
              class="px-4 py-2 bg-gray-500 text-white rounded-md"
            >
              Next
            </button>
          </div>
        </div>
      </div>

      <!-- Client Management Tab Content -->
      <div id="clientManagementContent" class="tab-content hidden">
        <h2 class="text-xl font-semibold mb-4">Client Management</h2>
        <div class="flex justify-between items-center mb-4">
          <div>
            <label
              for="clientManagementDropdown"
              class="block text-sm font-medium text-gray-700 mb-2"
              >Select Data Type:</label
            >
            <select
              id="clientManagementDropdown"
              class="w-full max-w-xs p-2 border rounded-md"
            >
              <option value="clients">Clients</option>
            </select>
          </div>
          <button
            id="addClientBtn"
            class="bg-[#12729C] px-4 py-2 rounded-md text-white hover:bg-[#0f5c80]"
          >
            Add New Client
          </button>
        </div>
        <div id="clientManagementList" class="space-y-4"></div>
      </div>

      <!-- Product Management Tab Content -->
      <div id="productManagementContent" class="tab-content hidden">
        <h2 class="text-xl font-semibold mb-4">Product Management</h2>
        <div class="flex justify-between items-center mb-4">
          <div>
            <label
              for="productManagementDropdown"
              class="block text-sm font-medium text-gray-700 mb-2"
            >
              Select Data Type:
            </label>
            <select
              id="productManagementDropdown"
              class="w-full max-w-xs p-2 border rounded-md"
            >
              <option value="services">Services</option>
            </select>
          </div>
          <button
            id="addServiceBtn"
            class="bg-[#12729C] px-4 py-2 rounded-md text-white hover:bg-[#0f5c80]"
          >
            Create New Service
          </button>
        </div>
        <div id="productManagementList" class="table-container space-y-4">
          <!-- Table will be dynamically populated here -->
        </div>
      </div>

      <!-- User Management Tab Content -->
      <div id="userManagementContent" class="tab-content hidden">
        <h2 class="text-xl font-semibold mb-4">User Management</h2>
        <div class="flex justify-between items-center mb-4">
          <div>
            <label
              for="userManagementDropdown"
              class="block text-sm font-medium text-gray-700 mb-2"
              >Select Data Type:</label
            >
            <select
              id="userManagementDropdown"
              class="w-full max-w-xs p-2 border rounded-md"
            >
              <option value="users">Users</option>
            </select>
          </div>
          <button
            id="addUserBtn"
            class="bg-[#12729C] px-4 py-2 rounded-md text-white hover:bg-[#0f5c80]"
          >
            Add New User
          </button>
        </div>
        <div id="userManagementList" class="space-y-4"></div>
      </div>

      <div id="countriesManagementContent" class="hidden p-4">
        <div class="flex justify-between mb-4">
          <h2 class="text-xl font-semibold">Countries Management</h2>
          <button id="addCountryBtn" class="bg-blue-500 text-white px-4 py-2 rounded">Add New</button>
        </div>
        <div id="countriesManagementList" class="relative"></div>
      </div>

      <!-- Add User Modal -->
      <div id="addUserModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Add New User</h2>
          <form id="addUserForm">
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Email Address <span class="text-red-500">*</span></label
              >
              <input
                type="email"
                id="userEmailAddress"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Phone Number <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userPhoneNumber"
                class="w-full p-2 border rounded-md"
                placeholder="+1234567890"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >First Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userFirstName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Last Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userLastName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Address <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userAddress"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >City</label
              >
              <input
                type="text"
                id="userCity"
                class="w-full p-2 border rounded-md"
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >State</label
              >
              <input
                type="text"
                id="userState"
                class="w-full p-2 border rounded-md"
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Country</label
              >
              <input
                type="text"
                id="userCountry"
                class="w-full p-2 border rounded-md"
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Role</label
              >
              <select id="userRole" class="w-full p-2 border rounded-md">
                <option value="">Select Role</option>
                <option value="ROLE_USER">User</option>
                <option value="ROLE_ADMIN">Admin</option>
              </select>
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelAddUserBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Add Provider Modal -->
      <div
        id="addProviderModal"
        class="modal fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden"
      >
        <div
          class="modal-content bg-white p-6 rounded-md shadow-md w-full max-w-md"
        >
          <h2 class="text-xl font-bold mb-4">Add Provider</h2>
          <form id="addProviderForm">
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Provider Name <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="addProviderName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Image URL
              </label>
              <input
                type="url"
                id="providerImage"
                class="w-full p-2 border rounded-md"
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Service Type <span class="text-red-500">*</span>
              </label>
              <select
                id="serviceType"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>
                  Select a service type
                </option>
                <option value="BillsPayment">Bills Payment</option>
                <option value="Remit">Remittance</option>
              </select>
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelAddProviderBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Add Category Modal -->
      <div id="addCategoryModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Add Category</h2>
          <form id="addCategoryForm">
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Category Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="categoryName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Description <span class="text-red-500">*</span></label
              >
              <textarea
                id="categoryDescription"
                class="w-full p-2 border rounded-md"
                required
              ></textarea>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Customer Validation Required
                <span class="text-red-500">*</span></label
              >
              <input
                type="checkbox"
                id="customerValidationRequired"
                class="p-2"
              />
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelAddCategoryBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Update Category Modal -->
      <div id="updateCategoryModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Update Category</h2>
          <form id="updateCategoryForm">
            <input type="hidden" id="updateCategoryId" />
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Category Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="updateCategoryName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Description <span class="text-red-500">*</span></label
              >
              <textarea
                id="updateCategoryDescription"
                class="w-full p-2 border rounded-md"
                required
              ></textarea>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Customer Validation Required
                <span class="text-red-500">*</span></label
              >
              <input
                type="checkbox"
                id="updateCustomerValidationRequired"
                class="p-2"
              />
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelUpdateCategoryBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Update
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Add Biller Modal -->
      <div id="addBillerModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Add Biller</h2>
          <form id="addBillerForm">
            <div class="mb-4">
              <label
                for="billerServiceId"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Service ID <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="billerServiceId"
                class="w-full p-2 border rounded-md"
                required
                placeholder="Enter unique service ID"
              />
            </div>

            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Provider ID <span class="text-red-500">*</span>
              </label>
              <select
                id="billerProviderId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select a provider</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="hidden text-sm font-medium text-gray-700">
                Operator ID <span class="text-red-500">*</span>
              </label>
              <select
                id="billerOperatorId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select an operator</option>
                <!-- Static options until endpoint provided -->
                <option value="OP1">Operator 1</option>
                <option value="OP2">Operator 2</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Name <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="billerName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Category ID <span class="text-red-500">*</span>
              </label>
              <select
                id="billerCategoryId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select a category</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Item Type <span class="text-red-500">*</span>
              </label>
              <select
                id="billerItemType"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select an item type</option>
                <option value="ProviderBaseBouquet">
                  Provider Base Bouquet
                </option>
                <option value="Regular">Regular</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Description <span class="text-red-500">*</span>
              </label>
              <textarea
                id="billerDescription"
                class="w-full p-2 border rounded-md"
                required
              ></textarea>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Country ID <span class="text-red-500">*</span>
              </label>
              <select
                id="billerCountryId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select a country</option>
                <!-- Static options until endpoint provided -->
                <option value="1">Nigeria (1)</option>
                <option value="2">Ghana (2)</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Min Amount <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="billerMinAmount"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Max Amount <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="billerMaxAmount"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelAddBillerBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Update Biller Modal -->
      <div id="updateBillerModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Update Biller</h2>
          <form id="updateBillerForm">
            <input type="hidden" id="updateBillerId" />
            <div class="mb-4">
              <label
                for="updateBillerServiceId"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Service ID <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="updateBillerServiceId"
                class="w-full p-2 border rounded-md"
                required
                placeholder="Enter unique service ID"
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Provider ID <span class="text-red-500">*</span>
              </label>
              <select
                id="updateBillerProviderId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled>Select a provider</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Operator ID <span class="text-red-500">*</span>
              </label>
              <select
                id="updateBillerOperatorId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled>Select an operator</option>
                <!-- Static options until endpoint provided -->
                <option value="OP1">Operator 1</option>
                <option value="OP2">Operator 2</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Name <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="updateBillerName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Category ID <span class="text-red-500">*</span>
              </label>
              <select
                id="updateBillerCategoryId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled>Select a category</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Item Type <span class="text-red-500">*</span>
              </label>
              <select
                id="updateBillerItemType"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select an item type</option>
                <option value="ProviderBaseBouquet">
                  Provider Base Bouquet
                </option>
                <option value="Regular">Regular</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Description <span class="text-red-500">*</span>
              </label>
              <textarea
                id="updateBillerDescription"
                class="w-full p-2 border rounded-md"
                required
              ></textarea>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Country ID <span class="text-red-500">*</span>
              </label>
              <select
                id="updateBillerCountryId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled>Select a country</option>
                <!-- Static options until endpoint provided -->
                <option value="1">Nigeria (1)</option>
                <option value="2">Ghana (2)</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Min Amount <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="updateBillerMinAmount"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700">
                Max Amount <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="updateBillerMaxAmount"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelUpdateBillerBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Update
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Add Configuration Modal -->
      <div id="addConfigurationModal" class="modal hidden">
        <div class="modal-content max-w-lg">
          <h2 class="text-xl font-bold mb-4">Add New Fee Configuration</h2>
          <form id="addConfigurationForm">
            <div class="mb-4">
              <label
                for="feeName"
                class="block text-sm font-medium text-gray-700"
                >Fee Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="feeName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label
                for="feeDescription"
                class="block text-sm font-medium text-gray-700"
                >Fee Description <span class="text-red-500">*</span></label
              >
              <textarea
                id="feeDescription"
                class="w-full p-2 border rounded-md"
                required
              ></textarea>
            </div>
            <div class="mb-4">
              <label
                for="feeAmount"
                class="block text-sm font-medium text-gray-700"
                >Fee Amount <span class="text-red-500">*</span></label
              >
              <input
                type="number"
                id="feeAmount"
                step="0.01"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label
                for="feeCurrency"
                class="block text-sm font-medium text-gray-700"
                >Fee Currency <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="feeCurrency"
                class="w-full p-2 border rounded-md"
                required
                placeholder="e.g., USD"
              />
            </div>
            <div class="mb-4">
              <label
                for="providerId"
                class="block text-sm font-medium text-gray-700"
                >Provider <span class="text-red-500">*</span></label
              >
              <select
                id="providerId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select a provider</option>
              </select>
            </div>
            <div class="mb-4">
              <label
                for="configCategoryId"
                class="block text-sm font-medium text-gray-700"
                >Category <span class="text-red-500">*</span></label
              >
              <select
                id="configCategoryId"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select a category</option>
              </select>
            </div>
            <div class="mb-4">
              <label
                for="taxRate"
                class="block text-sm font-medium text-gray-700"
                >Tax Rate (%)</label
              >
              <input
                type="number"
                id="taxRate"
                step="0.01"
                class="w-full p-2 border rounded-md"
                placeholder="e.g., 5.00"
              />
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelAddConfigurationBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Add Client Modal -->
      <div id="addClientModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Add Client Service</h2>
          <form id="addClientForm">
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Entity ID <span class="text-red-500">*</span></label
              >
              <input
                type="number"
                id="clientEntityId"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Application ID <span class="text-red-500">*</span></label
              >
              <input
                type="number"
                id="clientApplicationId"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Status <span class="text-red-500">*</span></label
              >
              <select
                id="clientStatus"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="ACTIVE">Active</option>
                <option value="INACTIVE">Inactive</option>
              </select>
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelAddClientBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Update Client Modal -->
      <div
        id="updateClientModal"
        class="modal hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center"
      >
        <div class="modal-content bg-white p-6 rounded-lg w-full max-w-md">
          <h2 class="text-xl font-semibold mb-4">Update Client Service</h2>
          <form id="updateClientForm">
            <input type="hidden" id="updateClientId" name="id" />
            <div class="mb-4">
              <label
                for="updateClientName"
                class="block text-sm font-medium text-gray-700"
                >Name *</label
              >
              <input
                type="text"
                id="updateClientName"
                name="name"
                required
                class="w-full p-2 border rounded-md"
              />
            </div>
            <div class="mb-4">
              <label
                for="updateClientDescription"
                class="block text-sm font-medium text-gray-700"
                >Description</label
              >
              <textarea
                id="updateClientDescription"
                name="description"
                class="w-full p-2 border rounded-md"
              ></textarea>
            </div>
            <div class="mb-4">
              <label
                for="updateClientCountry"
                class="block text-sm font-medium text-gray-700"
                >Country</label
              >
              <input
                type="text"
                id="updateClientCountry"
                name="country"
                class="w-full p-2 border rounded-md"
              />
            </div>
            <div class="mb-4">
              <label
                for="updateClientStatus"
                class="block text-sm font-medium text-gray-700"
                >Status *</label
              >
              <select
                id="updateClientStatus"
                name="status"
                required
                class="w-full p-2 border rounded-md"
              >
                <option value="Active">Active</option>
                <option value="Disabled">Disabled</option>
                <option value="Suspended">Suspended</option>
              </select>
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                onclick="hideModal('updateClientModal')"
                class="px-4 py-2 bg-gray-500 text-white rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="px-4 py-2 bg-[#12729C] text-white rounded-md"
              >
                Update
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- delete user modal -->
      <div
        id="deleteClientModal"
        class="modal hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center"
      >
        <div class="modal-content bg-white p-6 rounded-lg w-full max-w-sm">
          <h2 class="text-xl font-semibold mb-4">Confirm Delete</h2>
          <p class="mb-4">
            Are you sure you want to delete this client service?
          </p>
          <input type="hidden" id="deleteClientId" />
          <div class="flex justify-end space-x-2">
            <button
              type="button"
              onclick="hideModal('deleteClientModal')"
              class="px-4 py-2 bg-gray-500 text-white rounded-md"
            >
              Cancel
            </button>
            <button
              id="confirmDeleteClientBtn"
              class="px-4 py-2 bg-red-600 text-white rounded-md"
            >
              Delete
            </button>
          </div>
        </div>
      </div>

      <!-- Add Service Modal -->
      <div id="addServiceModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Create New Service</h2>
          <form id="addServiceForm">
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="serviceName"
                name="name"
                class="w-full p-2 border rounded-md"
                placeholder="e.g., Money Transfer"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Description <span class="text-red-500">*</span></label
              >
              <textarea
                id="serviceDescription"
                name="description"
                class="w-full p-2 border rounded-md"
                placeholder="e.g., This service allows sending money."
                required
              ></textarea>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Type <span class="text-red-500">*</span></label
              >
              <select
                id="serviceType"
                name="serviceType"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select a type</option>
                <option value="BillPayment">Bill Payment</option>
                <option value="Remittance">Remittance</option>
                <option value="CashOut">Cash Out</option>
                <option value="CashIn">Cash In</option>
                <option value="Offline">Offline</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Channel Type Code <span class="text-red-500">*</span></label
              >
              <select
                id="channelTypeCode"
                name="channelTypeCode"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select a channel</option>
                <option value="WEB">WEB</option>
                <option value="USSD">USSD</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Code <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="serviceCode"
                name="serviceCode"
                class="w-full p-2 border rounded-md"
                placeholder="e.g., 1001"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Category Code
                <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="serviceCategoryCode"
                name="serviceCategoryCode"
                class="w-full p-2 border rounded-md"
                placeholder="e.g., Finance"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Provider Code
                <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="serviceProviderCode"
                name="serviceProviderCode"
                class="w-full p-2 border rounded-md"
                placeholder="e.g., PROV123"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Country Code <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="countryCode"
                name="countryCode"
                class="w-full p-2 border rounded-md"
                placeholder="e.g., NG"
                required
              />
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelAddServiceBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Update Service Modal -->
      <div id="updateServiceModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Update Service</h2>
          <form id="updateServiceForm">
            <input type="hidden" id="updateServiceId" />
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="updateServiceName"
                name="name"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Description <span class="text-red-500">*</span></label
              >
              <textarea
                id="updateServiceDescription"
                name="description"
                class="w-full p-2 border rounded-md"
                required
              ></textarea>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Type <span class="text-red-500">*</span></label
              >
              <select
                id="updateServiceType"
                name="serviceType"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="BillPayment">Bill Payment</option>
                <option value="Remittance">Remittance</option>
                <option value="CashOut">Cash Out</option>
                <option value="CashIn">Cash In</option>
                <option value="Offline">Offline</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Channel Type Code <span class="text-red-500">*</span></label
              >
              <select
                id="updateChannelTypeCode"
                name="channelTypeCode"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="WEB">WEB</option>
                <option value="USSD">USSD</option>
              </select>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Code <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="updateServiceCode"
                name="serviceCode"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Category Code
                <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="updateServiceCategoryCode"
                name="serviceCategoryCode"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Service Provider Code
                <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="updateServiceProviderCode"
                name="serviceProviderCode"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Country Code <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="updateCountryCode"
                name="countryCode"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelUpdateServiceBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Update
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Add User Modal -->
      <div id="addUserModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Add New User</h2>
          <form id="addUserForm">
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Email Address <span class="text-red-500">*</span></label
              >
              <input
                type="email"
                id="userEmailAddress"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Phone Number <span class="text-red-500">*</span></label
              >
              <input
                type="tel"
                id="userPhoneNumber"
                class="w-full p-2 border rounded-md"
                required
                placeholder="+1234567890"
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >First Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userFirstName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Last Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userLastName"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Address <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userAddress"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >City <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userCity"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >State <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userState"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Country <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                id="userCountry"
                class="w-full p-2 border rounded-md"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Role <span class="text-red-500">*</span></label
              >
              <select
                id="userRole"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="" disabled selected>Select a role</option>
                <option value="ROLE_ADMIN">Admin</option>
                <option value="ROLE_USER">User</option>
              </select>
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelAddUserBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Update User Modal -->
      <div id="updateUserModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Update User</h2>
          <form id="updateUserForm">
            <input type="hidden" id="updateUserId" />
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Email Address</label
              >
              <input
                type="email"
                id="updateUserEmailAddress"
                class="w-full p-2 border rounded-md"
                disabled
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Full Name</label
              >
              <input
                type="text"
                id="updateUserFullName"
                class="w-full p-2 border rounded-md"
                disabled
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Role</label
              >
              <input
                type="text"
                id="updateUserRole"
                class="w-full p-2 border rounded-md"
                disabled
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700"
                >Action <span class="text-red-500">*</span></label
              >
              <select
                id="updateUserAction"
                class="w-full p-2 border rounded-md"
                required
              >
                <option value="ACTIVATE">Activate</option>
                <option value="DEACTIVATE">Deactivate</option>
              </select>
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="button"
                id="cancelUpdateUserBtn"
                class="bg-gray-300 px-4 py-2 rounded-md"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-[#12729C] px-4 py-2 rounded-md text-white"
              >
                Update
              </button>
            </div>
          </form>
        </div>
      </div>

      <div id="addCountryModal" class="modal" style="display: none">
        <div class="modal-content">
          <h2>Add New Country</h2>
          <form id="addCountryForm">
            <div class="mb-4">
              <label for="countryName" class="block text-gray-700"
                >Country Name *</label
              >
              <input
                id="countryName"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="countryCode" class="block text-gray-700"
                >Country Code *</label
              >
              <input
                id="countryCode"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="countryIsoCode" class="block text-gray-700"
                >ISO Code *</label
              >
              <input
                id="countryIsoCode"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="dialCode" class="block text-gray-700"
                >Dial Code *</label
              >
              <input
                id="dialCode"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="currencyCode" class="block text-gray-700"
                >Currency Code *</label
              >
              <input
                id="currencyCode"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="currencySymbol" class="block text-gray-700"
                >Currency Symbol *</label
              >
              <input
                id="currencySymbol"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="mobileLength" class="block text-gray-700"
                >Mobile Length</label
              >
              <input
                id="mobileLength"
                type="text"
                class="w-full p-2 border rounded"
              />
            </div>
            <div class="mb-4">
              <label for="billPaymentSupported" class="block text-gray-700"
                >Bill Payment Supported</label
              >
              <input id="billPaymentSupported" type="checkbox" />
            </div>
            <div class="mb-4">
              <label for="offlinePaymentSupported" class="block text-gray-700"
                >Offline Payment Supported</label
              >
              <input id="offlinePaymentSupported" type="checkbox" />
            </div>
            <div class="mb-4">
              <label for="countryStatus" class="block text-gray-700"
                >Status</label
              >
              <select id="countryStatus" class="w-full p-2 border rounded">
                <option value="Active">Active</option>
                <option value="Inactive">Inactive</option>
              </select>
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="submit"
                class="bg-blue-500 text-white px-4 py-2 rounded"
              >
                Add Country
              </button>
              <button
                type="button"
                id="cancelAddCountryBtn"
                class="bg-gray-300 px-4 py-2 rounded"
              >
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>

      <div id="updateCountryModal" class="modal" style="display: none">
        <div class="modal-content">
          <h2>Update Country</h2>
          <form id="updateCountryForm">
            <input id="updateCountryId" type="hidden" />
            <div class="mb-4">
              <label for="updateCountryName" class="block text-gray-700"
                >Country Name *</label
              >
              <input
                id="updateCountryName"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="updateCountryCode" class="block text-gray-700"
                >Country Code *</label
              >
              <input
                id="updateCountryCode"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="updateCountryIsoCode" class="block text-gray-700"
                >ISO Code *</label
              >
              <input
                id="updateCountryIsoCode"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="updateDialCode" class="block text-gray-700"
                >Dial Code *</label
              >
              <input
                id="updateDialCode"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="updateCurrencyCode" class="block text-gray-700"
                >Currency Code *</label
              >
              <input
                id="updateCurrencyCode"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="updateCurrencySymbol" class="block text-gray-700"
                >Currency Symbol *</label
              >
              <input
                id="updateCurrencySymbol"
                type="text"
                class="w-full p-2 border rounded"
                required
              />
            </div>
            <div class="mb-4">
              <label for="updateMobileLength" class="block text-gray-700"
                >Mobile Length</label
              >
              <input
                id="updateMobileLength"
                type="text"
                class="w-full p-2 border rounded"
              />
            </div>
            <div class="mb-4">
              <label
                for="updateBillPaymentSupported"
                class="block text-gray-700"
                >Bill Payment Supported</label
              >
              <input id="updateBillPaymentSupported" type="checkbox" />
            </div>
            <div class="mb-4">
              <label
                for="updateOfflinePaymentSupported"
                class="block text-gray-700"
                >Offline Payment Supported</label
              >
              <input id="updateOfflinePaymentSupported" type="checkbox" />
            </div>
            <div class="mb-4">
              <label for="updateCountryStatus" class="block text-gray-700"
                >Status</label
              >
              <select
                id="updateCountryStatus"
                class="w-full p-2 border rounded"
              >
                <option value="Active">Active</option>
                <option value="Inactive">Inactive</option>
              </select>
            </div>
            <div class="flex justify-end space-x-2">
              <button
                type="submit"
                class="bg-blue-500 text-white px-4 py-2 rounded"
              >
                Update Country
              </button>
              <button
                type="button"
                id="cancelUpdateCountryBtn"
                class="bg-gray-300 px-4 py-2 rounded"
              >
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>

      <div id="deleteCountryModal" class="modal" style="display: none">
        <div class="modal-content">
          <h2>Delete Country</h2>
          <p>Are you sure you want to delete this country?</p>
          <input id="deleteCountryId" type="hidden" />
          <div class="flex justify-end space-x-2">
            <button
              id="confirmDeleteCountryBtn"
              class="bg-red-500 text-white px-4 py-2 rounded"
            >
              Delete
            </button>
            <button
              id="cancelDeleteCountryBtn"
              class="bg-gray-300 px-4 py-2 rounded"
            >
              Cancel
            </button>
          </div>
        </div>
      </div>

      <!-- Complete Transaction Modal -->
      <div id="completeTransactionModal" class="modal">
        <div class="modal-content">
          <h2 class="text-xl font-bold mb-4">Complete Transaction</h2>
          <div id="transactionDetails" class="mb-4 space-y-2"></div>
          <div class="flex justify-end space-x-2">
            <button
              id="cancelCompleteTransactionBtn"
              class="bg-gray-300 px-4 py-2 rounded-md"
            >
              Cancel
            </button>
            <button
              id="rejectTransactionBtn"
              class="bg-red-500 px-4 py-2 rounded-md text-white hover:bg-red-600"
            >
              Reject Transaction
            </button>
            <button
              id="approveTransactionBtn"
              class="bg-green-500 px-4 py-2 rounded-md text-white hover:bg-green-600"
            >
              Approve Transaction
            </button>
          </div>
        </div>
      </div>

      <!-- Success/Error Modals -->
      <div id="successModal" class="modal">
        <div class="modal-content text-center">
          <h2 class="text-xl font-bold mb-4 text-green-600">Success</h2>
          <p id="successMessage" class="mb-4">Operation successful!</p>
          <button
            id="closeSuccessBtn"
            class="bg-[#12729C] px-4 py-2 rounded-md text-white hover:bg-[#0f5c80]"
          >
            Close
          </button>
        </div>
      </div>
      <div id="errorModal" class="modal">
        <div class="modal-content text-center">
          <h2 class="text-xl font-bold mb-4 text-red-600">Error</h2>
          <p id="errorMessage" class="mb-4">Operation failed!</p>
          <button
            id="closeErrorBtn"
            class="bg-[#12729C] px-4 py-2 rounded-md text-white hover:bg-[#0f5c80]"
          >
            Close
          </button>
        </div>
      </div>
    </div>

    <script src="sidenav.js"></script>
    <script>
      // Global token for API requests
      const token = new URLSearchParams(window.location.search).get("token");
      let currentTransactionsPage = 0;
      let currentDetailedRemittancePage = 0;
      let currentConfigurationPage = 0;
      const transactionsPageSize = 10;
      let currentTransactionTab = "standard";
      let currentUsersPage = 0;
      const usersPageSize = 5;

      // Utility Functions
      function showModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) modal.style.display = "block";
      }

      function hideModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) modal.style.display = "none";
      }

      function positionDropdown(button, dropdown) {
        const btnRect = button.getBoundingClientRect();
        const dropdownWidth = dropdown.offsetWidth;
        const dropdownHeight = dropdown.offsetHeight;
        const viewportWidth = window.innerWidth;
        const viewportHeight = window.innerHeight;

        // Position below the button by default
        let top = btnRect.bottom + window.scrollY; // Account for vertical scroll
        let left = btnRect.left + window.scrollX; // Account for horizontal scroll

        // Adjust if dropdown would overflow right edge
        if (left + dropdownWidth > viewportWidth) {
          left = btnRect.right + window.scrollX - dropdownWidth;
        }

        // Adjust if dropdown would overflow bottom edge
        if (top + dropdownHeight > viewportHeight + window.scrollY) {
          top = btnRect.top + window.scrollY - dropdownHeight; // Position above button
        }

        // Ensure it doesnt go off-screen on the left or top
        left = Math.max(0, left);
        top = Math.max(0, top);

        dropdown.style.top = `${top}px`;
        dropdown.style.left = `${left}px`;
      }

      function showSuccess(msg) {
        document.getElementById("successMessage").textContent = msg;
        showModal("successModal");
      }

      function showError(msg) {
        document.getElementById("errorMessage").textContent = msg;
        showModal("errorModal");
      }

      // Initialize page
      document.addEventListener("DOMContentLoaded", () => {
        if (!token) {
          window.location.href = `../signin.html?redirect=/BackOffice/management.html`;
          return;
        }
        window.history.replaceState({}, document.title, "management.html");

        setupTabs();
        setupBillsPayment();
        setupClientManagement();
        setupProductManagement();
        setupUserManagement();
        setupForms();
        setupModalEventListeners();
        setupCountriesManagement();
        fetchBillsPaymentData();

        // Ensure Start Date and End Date are not the same
        document
          .getElementById("startDate")
          .addEventListener("change", function () {
            const startDate = this.value;
            const endDateInput = document.getElementById("endDate");

            // Set min attribute for endDate to be at least one day after startDate
            if (startDate) {
              const nextDay = new Date(startDate);
              nextDay.setDate(nextDay.getDate() + 1);
              const minEndDate = nextDay.toISOString().split("T")[0];
              endDateInput.setAttribute("min", minEndDate);

              // Clear endDate if it's less than or equal to startDate
              if (endDateInput.value && endDateInput.value <= startDate) {
                endDateInput.value = "";
              }
            }
          });

        document
          .getElementById("endDate")
          .addEventListener("change", function () {
            const endDate = this.value;
            const startDateInput = document.getElementById("startDate");

            // Ensure endDate is after startDate
            if (startDateInput.value && endDate <= startDateInput.value) {
              this.value = "";
              alert("End Date must be after Start Date.");
            }
          });
      });

      // Tab Switching
      function setupTabs() {
        const tabs = [
          "billsPayment",
          "clientManagement",
          "productManagement",
          "userManagement",
          "countriesManagement", // Added
        ];
        tabs.forEach((tab) => {
          const tabElement = document.getElementById(`${tab}Tab`);
          if (tabElement) {
            tabElement.addEventListener("click", () => {
              tabs.forEach((t) => {
                document.getElementById(`${t}Content`).classList.add("hidden");
                document
                  .getElementById(`${t}Tab`)
                  .classList.remove("border-b-2", "border-blue-500");
              });
              document
                .getElementById(`${tab}Content`)
                .classList.remove("hidden");
              document
                .getElementById(`${tab}Tab`)
                .classList.add("border-b-2", "border-blue-500");
              if (tab === "billsPayment") fetchBillsPaymentData();
              if (tab === "clientManagement") fetchClientManagementData();
              if (tab === "productManagement") fetchProductManagementData();
              if (tab === "userManagement") fetchUserManagementData();
              if (tab === "countriesManagement") fetchCountriesManagementData();
            });
          }
        });
      }

      async function populateConfigurationDropdowns() {
        const providerSelect = document.querySelector(
          "#addConfigurationModal #providerId"
        );
        const categorySelect = document.querySelector(
          "#addConfigurationModal #configCategoryId"
        );

        console.log("Populating configuration dropdowns...");
        console.log(
          "providerSelect:",
          providerSelect ? providerSelect.outerHTML : "Not found"
        );
        console.log(
          "categorySelect:",
          categorySelect ? categorySelect.outerHTML : "Not found"
        );

        if (!providerSelect || !categorySelect) {
          const errorMsg =
            "Error: Configuration dropdowns not found in addConfigurationModal.";
          console.error(errorMsg, { providerSelect, categorySelect });
          showError(errorMsg);
          return;
        }

        if (!(providerSelect instanceof HTMLSelectElement)) {
          const errorMsg = "Error: providerId is not a select element.";
          console.error(errorMsg, providerSelect);
          showError(errorMsg);
          return;
        }

        if (!(categorySelect instanceof HTMLSelectElement)) {
          const errorMsg = "Error: configCategoryId is not a select element.";
          console.error(errorMsg, categorySelect);
          showError(errorMsg);
          return;
        }

        try {
          // Fetch providers
          console.log("Fetching providers...");
          const providerResponse = await fetch(
            "http://45.91.171.213:9080/api/manage/bills-payment/providers",
            {
              headers: { Authorization: `Bearer ${token}` },
            }
          );
          if (!providerResponse.ok) {
            const errorText = await providerResponse.text();
            const errorMsg = `Failed to fetch providers: ${
              errorText || providerResponse.status
            }`;
            throw new Error(errorMsg);
          }
          const providerData = await providerResponse.json();
          console.log(
            "Raw providers response:",
            JSON.stringify(providerData, null, 2)
          );
          providerSelect.innerHTML =
            '<option value="" disabled selected>Select a provider</option>';
          if (providerData.data?.length) {
            // Include all valid providers
            const validProviders = providerData.data.filter(
              (provider) =>
                provider && provider.id && !isNaN(parseInt(provider.id))
            );
            console.log(
              "Valid providers:",
              JSON.stringify(validProviders, null, 2)
            );
            if (validProviders.length) {
              validProviders.forEach((provider) => {
                const option = document.createElement("option");
                option.value = parseInt(provider.id);
                option.textContent =
                  provider.providerName || `Provider ${provider.id}`;
                console.log("Adding provider option:", {
                  value: option.value,
                  text: option.textContent,
                  provider: provider,
                });
                providerSelect.appendChild(option);
              });
            } else {
              console.warn("No valid providers available");
              providerSelect.innerHTML +=
                '<option value="" disabled>No valid providers available</option>';
            }
          } else {
            console.warn("No providers available");
            providerSelect.innerHTML +=
              '<option value="" disabled>No providers available</option>';
          }

          // Fetch categories
          console.log("Fetching categories...");
          const categoryResponse = await fetch(
            "http://45.91.171.213:9080/api/manage/bills-payment/categories",
            {
              headers: { Authorization: `Bearer ${token}` },
            }
          );
          if (!categoryResponse.ok) {
            const errorText = await categoryResponse.text();
            const errorMsg = `Failed to fetch categories: ${
              errorText || categoryResponse.status
            }`;
            throw new Error(errorMsg);
          }
          const categoryData = await categoryResponse.json();
          console.log(
            "Categories response:",
            JSON.stringify(categoryData, null, 2)
          );
          categorySelect.innerHTML =
            '<option value="" disabled selected>Select a category</option>';
          if (categoryData.data?.length) {
            categoryData.data.forEach((category) => {
              const option = document.createElement("option");
              option.value = category.id;
              option.textContent = category.name || "Unnamed Category";
              console.log("Adding category option:", {
                value: option.value,
                text: option.textContent,
              });
              categorySelect.appendChild(option);
            });
            console.log(
              "Category dropdown HTML after population:",
              categorySelect.innerHTML
            );
          } else {
            console.warn("No categories available");
            categorySelect.innerHTML +=
              '<option value="" disabled>No categories available</option>';
          }
        } catch (error) {
          const errorMsg = `Error loading dropdowns: ${error.message}`;
          console.error(errorMsg, error);
          showError(errorMsg);
        }
      }

      function setupAddConfigurationForm() {
        const form = document.getElementById("addConfigurationForm");
        const cancelBtn = document.getElementById("cancelAddConfigurationBtn");

        if (form) {
          form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const feeName = document.getElementById("feeName").value;
            const feeDescription =
              document.getElementById("feeDescription").value;
            const feeAmount = parseFloat(
              document.getElementById("feeAmount").value
            );
            const feeCurrency = document.getElementById("feeCurrency").value;
            const providerSelect = document.querySelector(
              "#addConfigurationModal #providerId"
            );
            const providerId = providerSelect
              ? parseInt(providerSelect.value)
              : null;
            const categorySelect = document.querySelector(
              "#addConfigurationModal #configCategoryId"
            );
            const categoryId = categorySelect
              ? parseInt(categorySelect.value)
              : null;

            // Log provider dropdown options
            const providerOptions = providerSelect
              ? Array.from(providerSelect.options).map((opt) => ({
                  value: opt.value,
                  text: opt.textContent,
                }))
              : [];
            console.log("Provider dropdown options:", providerOptions);

            console.log("Submitting configuration form:", {
              feeName,
              feeDescription,
              feeAmount,
              feeCurrency,
              providerId,
              categoryId,
            });
            alert(
              `Submitting form with providerId: ${
                providerId || "none"
              }, categoryId: ${categoryId || "none"}`
            );

            if (!providerSelect || !providerId || isNaN(providerId)) {
              const errorMsg = "Please select a valid provider.";
              alert(errorMsg);
              console.error(errorMsg, { providerSelect, providerId });
              showError(errorMsg);
              return;
            }

            if (!categorySelect || !categoryId || isNaN(categoryId)) {
              const errorMsg = "Please select a valid category.";
              alert(errorMsg);
              console.error(errorMsg, { categorySelect, categoryId });
              showError(errorMsg);
              return;
            }

            try {
              alert("Sending fee data to server...");
              console.log(
                "Sending fee data:",
                JSON.stringify(
                  {
                    feeName,
                    feeDescription,
                    feeAmount,
                    feeCurrency,
                    providerId,
                    categoryId,
                    taxRate: document.getElementById("taxRate").value
                      ? parseFloat(document.getElementById("taxRate").value)
                      : null,
                  },
                  null,
                  2
                )
              );
              const response = await fetch(
                "http://45.91.171.213:9080/api/manage/bills-payment/fees/add",
                {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: `Bearer ${token}`,
                  },
                  body: JSON.stringify({
                    feeName,
                    feeDescription,
                    feeAmount,
                    feeCurrency,
                    providerId,
                    categoryId,
                    taxRate: document.getElementById("taxRate").value
                      ? parseFloat(document.getElementById("taxRate").value)
                      : null,
                  }),
                }
              );

              const responseText = await response.text();
              console.log("Add fee response:", responseText);
              if (!response.ok) {
                const errorMsg = `Failed to add fee: ${
                  responseText || response.status
                }`;
                alert(errorMsg);
                throw new Error(errorMsg);
              }
              alert("Fee added successfully!");
              console.log("Fee added successfully");
              showSuccess("Fee added successfully!");
              hideModal("addConfigurationModal");
              form.reset();
              fetchBillsPaymentData();
            } catch (error) {
              const errorMsg = `Error adding fee: ${error.message}`;
              alert(errorMsg);
              console.error(errorMsg, error);
              showError(errorMsg);
            }
          });
        }

        if (cancelBtn) {
          cancelBtn.addEventListener("click", () => {
            hideModal("addConfigurationModal");
            form.reset();
          });
        }
      }

      // Bills Payment Section
      function setupBillsPayment() {
        const dropdown = document.getElementById("billsPaymentDropdown");
        const addBtn = document.getElementById("addBillsPaymentBtn");
        const filterForm = document.getElementById("billsPaymentFilterForm");
        const resetBtn = document.getElementById("resetFilters");
        const toggleFilterBtn = document.getElementById("toggleFilterBtn");
        const transactionsControls = document.getElementById(
          "transactionsControls"
        );
        const transactionsTabs = document.getElementById("transactionsTabs");
        const filterContainer = document.getElementById(
          "transactionsFilterContainer"
        );

        function toggleControls() {
          const type = dropdown.value;
          addBtn.classList.toggle(
            "hidden",
            !(
              (
                type === "billers" ||
                type === "categories" ||
                type === "configuration" ||
                type === "providers"
              ) // Added providers
            )
          );
          transactionsControls.classList.toggle(
            "hidden",
            type !== "transactions"
          );
          transactionsTabs.classList.toggle("hidden", type !== "transactions");
          if (type !== "transactions") {
            filterContainer.classList.add("hidden");
          }
        }

        toggleControls();

        if (dropdown) {
          dropdown.addEventListener("change", () => {
            currentTransactionsPage = 1;
            currentDetailedRemittancePage = 1;
            currentConfigurationPage = 1;
            toggleControls();
            fetchBillsPaymentData();
          });
        }

        if (addBtn) {
          addBtn.addEventListener("click", () => {
            const type = dropdown.value;
            if (type === "categories") showModal("addCategoryModal");
            else if (type === "billers") {
              populateBillerDropdowns();
              showModal("addBillerModal");
            } else if (type === "configuration") {
              console.log("Opening add configuration modal...");
              populateConfigurationDropdowns();
              showModal("addConfigurationModal");
            } else if (type === "providers") {
              showModal("addProviderModal"); // Added providers
            }
          });
        }

        if (toggleFilterBtn) {
          toggleFilterBtn.addEventListener("click", () => {
            filterContainer.classList.toggle("hidden");
          });
        }

        if (filterForm) {
          filterForm.addEventListener("submit", async (e) => {
            e.preventDefault();
            currentTransactionsPage = 1;
            currentDetailedRemittancePage = 1;
            currentConfigurationPage = 1;
            await fetchBillsPaymentData();
          });
        }

        if (resetBtn) {
          resetBtn.addEventListener("click", () => {
            filterForm.reset();
            currentTransactionsPage = 1;
            currentDetailedRemittancePage = 1;
            currentConfigurationPage = 1;
            fetchBillsPaymentData();
          });
        }

        if (document.getElementById("retryFetchTransactions")) {
          document
            .getElementById("retryFetchTransactions")
            .addEventListener("click", () => {
              currentTransactionsPage = 1;
              currentDetailedRemittancePage = 1;
              currentConfigurationPage = 1;
              fetchBillsPaymentData();
            });
        }

        document
          .getElementById("prevTransactions")
          ?.addEventListener("click", () => {
            if (
              currentTransactionTab === "standard" &&
              currentTransactionsPage > 1
            ) {
              currentTransactionsPage--;
            } else if (
              currentTransactionTab === "detailedRemittance" &&
              currentDetailedRemittancePage > 1
            ) {
              currentDetailedRemittancePage--;
            } else if (
              type === "configuration" &&
              currentConfigurationPage > 1
            ) {
              currentConfigurationPage--;
            }
            fetchBillsPaymentData();
          });

        document
          .getElementById("nextTransactions")
          ?.addEventListener("click", () => {
            if (currentTransactionTab === "standard") {
              currentTransactionsPage++;
            } else if (currentTransactionTab === "detailedRemittance") {
              currentDetailedRemittancePage++;
            } else if (type === "configuration") {
              currentConfigurationPage++;
            }
            fetchBillsPaymentData();
          });

        const standardTab = document.getElementById("standardTab");
        const detailedRemittanceTab = document.getElementById(
          "detailedRemittanceTab"
        );

        if (standardTab) {
          standardTab.addEventListener("click", () => {
            currentTransactionTab = "standard";
            currentTransactionsPage = 1;
            standardTab.classList.add("border-b-2", "border-blue-500");
            detailedRemittanceTab.classList.remove(
              "border-b-2",
              "border-blue-500"
            );
            fetchBillsPaymentData();
          });
        }

        if (detailedRemittanceTab) {
          detailedRemittanceTab.addEventListener("click", () => {
            currentTransactionTab = "detailedRemittance";
            currentDetailedRemittancePage = 1;
            detailedRemittanceTab.classList.add(
              "border-b-2",
              "border-blue-500"
            );
            standardTab.classList.remove("border-b-2", "border-blue-500");
            fetchBillsPaymentData();
          });
        }

        setupAddConfigurationForm();
      }

      // Replace the existing fetchBillsPaymentData function
      async function fetchBillsPaymentData() {
        const dropdown = document.getElementById("billsPaymentDropdown");
        const list = document.getElementById("billsPaymentList");
        const transactionsControls = document.getElementById(
          "transactionsControls"
        );
        const paginationContainer = document.getElementById(
          "transactionsPagination"
        );
        list.innerHTML = "<p>Loading...</p>";

        const endpoints = {
          transactions: {
            standard:
              "http://45.91.171.213:9080/api/manage/bills-payment/transactions",
            detailedRemittance:
              "http://45.91.171.213:9080/api/manage/remittance/transactions",
          },
          providers:
            "http://45.91.171.213:9080/api/manage/bills-payment/providers",
          categories:
            "http://45.91.171.213:9080/api/manage/bills-payment/categories",
          billers: "http://45.91.171.213:9080/api/manage/bills-payment/billers",
          configuration:
            "http://45.91.171.213:9080/api/manage/bills-payment/fees",
        };

        const type = dropdown.value;

        try {
          if (type === "transactions") {
            transactionsControls.classList.remove("hidden");
            paginationContainer.classList.remove("hidden");

            const filters = {
              categoryName: document.getElementById("categoryId")?.value || "",
              providerName:
                document.getElementById("providerName")?.value || "",
              agentMobileNumber:
                document.getElementById("agentMobileNumber")?.value || "",
              countryId: document.getElementById("countryId")?.value || "",
              status: document.getElementById("workflowStatus")?.value || "",
              customerReference:
                document.getElementById("customerReference")?.value || "",
              requestDate: document.getElementById("requestDate")?.value || "",
              startDate: document.getElementById("startDate")?.value || "",
              endDate: document.getElementById("endDate")?.value || "",
              page:
                currentTransactionTab === "detailedRemittance"
                  ? currentDetailedRemittancePage
                  : currentTransactionsPage,
              size: transactionsPageSize,
              sortColumn:
                document.getElementById("sortColumn")?.value || "createdAt",
              sortDirection:
                document.getElementById("sortDirection")?.value || "desc",
            };

            const queryParams = new URLSearchParams();
            Object.entries(filters).forEach(([key, value]) => {
              if (value !== "") queryParams.append(key, value);
            });

            if (filters.requestDate) {
              queryParams.delete("startDate");
              queryParams.delete("endDate");
              queryParams.set("startDate", filters.requestDate);
              const nextDay = new Date(filters.requestDate);
              nextDay.setDate(nextDay.getDate() + 1);
              queryParams.set("endDate", nextDay.toISOString().split("T")[0]);
            }

            const endpoint =
              currentTransactionTab === "detailedRemittance"
                ? endpoints.transactions.detailedRemittance
                : endpoints.transactions.standard;
            const response = await fetch(
              `${endpoint}?${queryParams.toString()}`,
              {
                headers: { Authorization: `Bearer ${token}` },
              }
            );

            if (!response.ok)
              throw new Error(`HTTP error! status: ${response.status}`);
            const data = await response.json();

            if (!data.data || !data.data.records || !data.data.records.length) {
              list.innerHTML = `<p>No ${currentTransactionTab} transactions found.</p>`;
            } else {
              updateTransactionsPagination(data.data);
              list.innerHTML = renderBillsPaymentList(type, data.data.records);
            }
          } else {
            transactionsControls.classList.add("hidden");
            paginationContainer.classList.add("hidden");

            const queryParams = new URLSearchParams();
            if (type === "configuration") {
              queryParams.append("page", currentConfigurationPage);
              queryParams.append("size", transactionsPageSize);
            }

            const endpoint = `${endpoints[type]}${
              queryParams.toString() ? "?" + queryParams.toString() : ""
            }`;
            const response = await fetch(endpoint, {
              headers: { Authorization: `Bearer ${token}` },
            });
            if (!response.ok)
              throw new Error(`HTTP error! status: ${response.status}`);
            const data = await response.json();

            if (type === "configuration") {
              list.innerHTML = renderBillsPaymentList(
                type,
                data.data.records || []
              );
              updateTransactionsPagination(data.data);
            } else {
              list.innerHTML = renderBillsPaymentList(type, data.data || []);
            }
          }

          attachBillsPaymentEventListeners();
        } catch (error) {
          showError(error.message);
          list.innerHTML = renderBillsPaymentList(type, []);
        }
      }

      // Reset Filter Form (unchanged)
      document
        .getElementById("resetFilters")
        ?.addEventListener("click", function () {
          const form = document.getElementById("billsPaymentFilterForm");
          form.reset();
          currentTransactionsPage = 0; // Reset to first page
          fetchBillsPaymentData(); // Fetch with no filters
        });

      function getTransactionFilters() {
        const filters = {
          categoryName: document.getElementById("categoryId")?.value || "",
          providerName: document.getElementById("providerName")?.value || "",
          agentMobileNumber:
            document.getElementById("agentMobileNumber")?.value || "",
          countryId: document.getElementById("countryId")?.value || "",
          status: document.getElementById("workflowStatus")?.value || "",
          customerReference:
            document.getElementById("customerReference")?.value || "",
          requestDate: document.getElementById("requestDate")?.value || "", // Added
          startDate: document.getElementById("startDate")?.value || "",
          endDate: document.getElementById("endDate")?.value || "",
        };
        return filters;
      }

      function updateTransactionsPagination(paginationData) {
        const { page, pageSize, totalPages, totalCount } = paginationData;
        const prevBtn = document.getElementById("prevTransactions");
        const nextBtn = document.getElementById("nextTransactions");
        const pageInfo = document.getElementById("transactionsPageInfo");

        console.log("Pagination data:", {
          page,
          pageSize,
          totalPages,
          totalCount,
        });

        prevBtn.disabled = page === 1; // 1-based
        nextBtn.disabled = page >= totalPages; // No -1 needed
        pageInfo.textContent = `Page ${page} of ${totalPages} (Total: ${totalCount} transactions)`; // No +1 needed
      }

      function renderBillsPaymentList(type, items) {
        if (!items || !items.length) {
          return `<p class='text-gray-500 text-center py-4'>No ${type} found.</p>`;
        }

        if (type === "transactions") {
          if (currentTransactionTab === "detailedRemittance") {
            return `
        <table class="min-w-full bg-white rounded-md shadow-md">
          <thead>
            <tr class="bg-gray-200 text-gray-700">
              <th class="px-6 py-3 text-left">Receiving Country</th>
              <th class="px-6 py-3 text-left">Sending Country</th>
              <th class="px-6 py-3 text-left">Beneficiary Currency</th>
              <th class="px-6 py-3 text-left">Transaction Amount</th>
              <th class="px-6 py-3 text-left">Conversion Rate</th>
              <th class="px-6 py-3 text-left">Amount Charged</th>
              <th class="px-6 py-3 text-left">Amount Paid</th>
              <th class="px-6 py-3 text-left">Comment</th>
              <th class="px-6 py-3 text-left">Sending Currency</th>
              <th class="px-6 py-3 text-left">Beneficiary Country</th>
              <th class="px-6 py-3 text-left">Remit Type</th>
              <th class="px-6 py-3 text-left">Agent Mobile</th>
              <th class="px-6 py-3 text-left">Provider Name</th>
              <th class="px-6 py-3 text-left">Transfer Reference</th>
              <th class="px-6 py-3 text-left">Created At</th>
              <th class="px-6 py-3 text-left">Status</th>
              <th class="px-6 py-3 text-left">Assigned To</th>
              <th class="px-6 py-3 text-left">Source Country Code</th>
            </tr>
          </thead>
          <tbody>
            ${items
              .map(
                (tx) => `
                  <tr class="border-b">
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.receivingCountry || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.sendingCountry || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.beneficiaryCurrency || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.transactionAmount
                        ? tx.transactionAmount.toFixed(2)
                        : "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.conversionRate ? tx.conversionRate.toFixed(4) : "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.amountToBeCharged
                        ? tx.amountToBeCharged.toFixed(2)
                        : "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.amountToBePaid ? tx.amountToBePaid.toFixed(2) : "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.comment || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.sendingCurrency || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.beneficiaryCountry || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.remitType || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.agentMobileNumber || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.providerName || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.transferReference || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.createdAt
                        ? new Date(tx.createdAt).toLocaleString()
                        : "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.workflowStatus || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.assignedTo || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.sourceCountryCode || "N/A"
                    }</td>
                  </tr>
                `
              )
              .join("")}
          </tbody>
        </table>
      `;
          } else {
            return `
        <table class="min-w-full bg-white rounded-md shadow-md">
          <thead>
            <tr class="bg-gray-200 text-gray-700">
              <th class="px-6 py-3 text-left">Request Reference</th>
              <th class="px-6 py-3 text-left">Customer Reference</th>
              <th class="px-6 py-3 text-left">Amount</th>
              <th class="px-6 py-3 text-left">Country</th>
              <th class="px-6 py-3 text-left">Agent Mobile</th>
              <th class="px-6 py-3 text-left">Provider</th>
              <th class="px-6 py-3 text-left">Created At</th>
              <th class="px-6 py-3 text-left">Status</th>
              <th class="px-6 py-3 text-left">Action</th>
            </tr>
          </thead>
          <tbody>
            ${items
              .map(
                (tx) => `
                  <tr class="border-b">
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.requestReference || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.customerReference || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.amount || "N/A"
                    } ${tx.currency || ""}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.countryName || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.agentMobileNumber || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.providerName || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap">${
                      tx.createdAt
                        ? new Date(tx.createdAt).toLocaleString()
                        : "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-green-500">${
                      tx.status || "N/A"
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap relative">
                      <button class="actionBtn" data-transaction='${JSON.stringify(
                        tx
                      )}'>
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                          <path d="M10 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4z" />
                        </svg>
                      </button>
                      <div class="dropdown-menu" id="dropdown-${
                        tx.requestReference || tx.id
                      }">
                        <button class="completeTransactionBtn" data-transaction='${JSON.stringify(
                          tx
                        )}'>Complete Transaction</button>
                      </div>
                    </td>
                  </tr>
                `
              )
              .join("")}
          </tbody>
        </table>
      `;
          }
        } else if (type === "providers") {
          return items
            .map(
              (provider) => `
          <div class="bg-white p-4 rounded-md shadow-md flex justify-between items-center">
            <div class="text-gray-700">
              <p class="font-medium">Name: ${provider.providerName}</p>
              <img src="${provider.imageUrl}" alt="${provider.providerName}" class="w-16 h-16 object-cover mt-2 rounded">
            </div>
          </div>
        `
            )
            .join("");
        } else if (type === "categories") {
          return `
      <table class="min-w-full bg-white rounded-md shadow-md">
        <thead>
          <tr class="bg-gray-200 text-gray-700">
            <th class="px-6 py-3 text-left">Name</th>
            <th class="px-6 py-3 text-left">Description</th>
            <th class="px-6 py-3 text-left">Validation Required</th>
            <th class="px-6 py-3 text-left">Actions</th>
          </tr>
        </thead>
        <tbody>
          ${items
            .map(
              (category) => `
                <tr class="border-b">
                  <td class="px-6 py-4 whitespace-nowrap">${
                    category.name || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    category.description || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    category.customerValidationRequired ? "Yes" : "No"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap relative">
                    <button class="actionBtn" data-id="${category.id}">
                      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4z" />
                      </svg>
                    </button>
                    <div class="dropdown-menu" id="dropdown-${category.id}">
                      <button class="updateCategoryBtn" 
                        data-id="${category.id}" 
                        data-name="${category.name || ""}" 
                        data-description="${category.description || ""}" 
                        data-validation="${
                          category.customerValidationRequired || false
                        }">Update</button>
                      <button class="deleteBtn" 
                        data-type="category" 
                        data-id="${category.id}">Delete</button>
                    </div>
                  </td>
                </tr>
              `
            )
            .join("")}
        </tbody>
      </table>
    `;
        } else if (type === "billers") {
          return `
      <table class="min-w-full bg-white rounded-md shadow-md">
        <thead>
          <tr class="bg-gray-200 text-gray-700">
            <th class="px-6 py-3 text-left">Name</th>
            <th class="px-6 py-3 text-left">Service ID</th>
            <th class="px-6 py-3 text-left">Category ID</th>
            <th class="px-6 py-3 text-left">Description</th>
            <th class="px-6 py-3 text-left">Actions</th>
          </tr>
        </thead>
        <tbody>
          ${items
            .map(
              (biller) => `
                <tr class="border-b">
                  <td class="px-6 py-4 whitespace-nowrap">${
                    biller.name || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    biller.serviceId || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    biller.categoryId || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    biller.description || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap relative">
                    <button class="actionBtn" data-id="${biller.id}">
                      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4z" />
                      </svg>
                    </button>
                    <div class="dropdown-menu" id="dropdown-${biller.id}">
                      <button class="updateBillerBtn" 
                        data-id="${biller.id}" 
                        data-service-id="${biller.serviceId || ""}" 
                        data-provider-id="${biller.providerId || ""}" 
                        data-operator-id="${biller.operatorId || ""}" 
                        data-name="${biller.name || ""}" 
                        data-category-id="${biller.categoryId || ""}" 
                        data-item-type="${biller.itemType || ""}" 
                        data-description="${biller.description || ""}" 
                        data-country-id="${biller.countryId || ""}" 
                        data-min-amount="${biller.minAmount || ""}" 
                        data-max-amount="${
                          biller.maxAmount || ""
                        }">Update</button>
                      <button class="deleteBtn" 
                        data-type="biller" 
                        data-id="${biller.id}" 
                        data-service-id="${
                          biller.serviceId || ""
                        }">Delete</button>
                    </div>
                  </td>
                </tr>
              `
            )
            .join("")}
        </tbody>
      </table>
    `;
        } else if (type === "configuration") {
          return `
      <table class="min-w-full bg-white rounded-md shadow-md">
        <thead>
          <tr class="bg-gray-200 text-gray-700">
            <th class="px-6 py-3 text-left">ID</th>
            <th class="px-6 py-3 text-left">Fee Name</th>
            <th class="px-6 py-3 text-left">Description</th>
            <th class="px-6 py-3 text-left">Fee Amount</th>
            <th class="px-6 py-3 text-left">Provider</th>
            <th class="px-6 py-3 text-left">Category</th>
            <th class="px-6 py-3 text-left">Tax Rate (%)</th>
            <th class="px-6 py-3 text-left">Created By</th>
            <th class="px-6 py-3 text-left">Created At</th>
            <th class="px-6 py-3 text-left">Updated By</th>
            <th class="px-6 py-3 text-left">Updated At</th>
          </tr>
        </thead>
        <tbody>
          ${items
            .map(
              (fee) => `
                <tr class="border-b">
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.id || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.feeName || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.feeDescription || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.feeAmount ? fee.feeAmount.toFixed(2) : "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.providerName || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.categoryName || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.taxRate ? fee.taxRate.toFixed(2) : "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.createdBy || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.createAt
                      ? new Date(fee.createAt).toLocaleString()
                      : "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.updatedBy || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    fee.updateAt
                      ? new Date(fee.updateAt).toLocaleString()
                      : "N/A"
                  }</td>
                </tr>
              `
            )
            .join("")}
        </tbody>
      </table>
    `;
        }
      }

      function attachBillsPaymentEventListeners() {
        // Action Button Handlers for all tables
        document.querySelectorAll(".actionBtn").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            e.stopPropagation();
            const dropdown = btn.nextElementSibling;
            const isVisible = dropdown.style.display === "block";

            // Close all other dropdowns
            document.querySelectorAll(".dropdown-menu").forEach((d) => {
              if (d !== dropdown) {
                d.style.display = "none";
              }
            });

            // Toggle current dropdown
            if (!isVisible) {
              dropdown.style.display = "block";
              positionDropdown(btn, dropdown); // Position the dropdown correctly
            } else {
              dropdown.style.display = "none";
            }
          });
        });

        // Complete Transaction Button
        document.querySelectorAll(".completeTransactionBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.getElementById("completeTransactionId").value =
              btn.dataset.id;
            showModal("completeTransactionModal");
          });
        });

        // Update Provider Button
        document.querySelectorAll(".updateProviderBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.getElementById("updateProviderId").value = btn.dataset.id;
            document.getElementById("updateProviderName").value =
              btn.dataset.name;
            document.getElementById("updateProviderDescription").value =
              btn.dataset.description;
            showModal("updateProviderModal");
          });
        });

        // Delete Provider Button
        document.querySelectorAll(".deleteProviderBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.getElementById("deleteProviderId").value = btn.dataset.id;
            showModal("deleteProviderModal");
          });
        });

        // Update Category Button
        document.querySelectorAll(".updateCategoryBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.getElementById("updateCategoryId").value = btn.dataset.id;
            document.getElementById("updateCategoryName").value =
              btn.dataset.name;
            document.getElementById("updateCategoryDescription").value =
              btn.dataset.description;
            showModal("updateCategoryModal");
          });
        });

        // Delete Category Button
        document.querySelectorAll(".deleteCategoryBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.getElementById("deleteCategoryId").value = btn.dataset.id;
            showModal("deleteCategoryModal");
          });
        });

        // Update Biller Button
        document.querySelectorAll(".updateBillerBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.getElementById("updateBillerId").value = btn.dataset.id;
            document.getElementById("updateBillerName").value =
              btn.dataset.name;
            document.getElementById("updateBillerDescription").value =
              btn.dataset.description;
            showModal("updateBillerModal");
          });
        });

        // Delete Biller Button
        document.querySelectorAll(".deleteBillerBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.getElementById("deleteBillerId").value = btn.dataset.id;
            showModal("deleteBillerModal");
          });
        });

        // Form Submission Listeners
        document
          .getElementById("completeTransactionForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const id = document.getElementById("completeTransactionId").value;
            try {
              const response = await fetch(
                `http://45.91.171.213:9080/api/bills/complete/${id}`,
                {
                  method: "POST",
                  headers: { Authorization: `Bearer ${token}` },
                }
              );
              if (!response.ok)
                throw new Error(`HTTP error! status: ${response.status}`);
              hideModal("completeTransactionModal");
              fetchBillsPaymentData(); // Refresh data
            } catch (error) {
              showError(error.message);
            }
          });

        document
          .getElementById("updateProviderForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const id = document.getElementById("updateProviderId").value;
            const name = document.getElementById("updateProviderName").value;
            const description = document.getElementById(
              "updateProviderDescription"
            ).value;
            try {
              const response = await fetch(
                `http://45.91.171.213:9080/api/bills/providers/${id}`,
                {
                  method: "PUT",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: `Bearer ${token}`,
                  },
                  body: JSON.stringify({ name, description }),
                }
              );
              if (!response.ok)
                throw new Error(`HTTP error! status: ${response.status}`);
              hideModal("updateProviderModal");
              fetchBillsPaymentData();
            } catch (error) {
              showError(error.message);
            }
          });

        document
          .getElementById("confirmDeleteProviderBtn")
          ?.addEventListener("click", async () => {
            const id = document.getElementById("deleteProviderId").value;
            try {
              const response = await fetch(
                `http://45.91.171.213:9080/api/bills/providers/${id}`,
                {
                  method: "DELETE",
                  headers: { Authorization: `Bearer ${token}` },
                }
              );
              if (!response.ok)
                throw new Error(`HTTP error! status: ${response.status}`);
              hideModal("deleteProviderModal");
              fetchBillsPaymentData();
            } catch (error) {
              showError(error.message);
            }
          });

        // Add similar form listeners for Categories and Billers if needed
      }

      // Client Management Section
      function setupClientManagement() {
        const dropdown = document.getElementById("clientManagementDropdown");
        const addBtn = document.getElementById("addClientBtn");

        if (dropdown)
          dropdown.addEventListener("change", fetchClientManagementData);
        if (addBtn)
          addBtn.addEventListener("click", () => showModal("addClientModal"));

        document
          .getElementById("updateClientForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const btn = document.querySelector(
              `.updateClientBtn[data-id="${
                document.getElementById("updateClientId").value
              }"]`
            );
            const payload = {
              id: parseInt(document.getElementById("updateClientId").value),
              name: document.getElementById("updateClientName").value,
              description: document.getElementById("updateClientDescription")
                .value,
              country:
                document.getElementById("updateClientCountry").value || null,
              status: document.getElementById("updateClientStatus").value,
              serviceType: btn.dataset.serviceType || "BillPayment", // Default if missing
              createAt: btn.dataset.createAt || "",
              createdBy: btn.dataset.createdBy
                ? parseInt(btn.dataset.createdBy)
                : 0,
              channelTypeCode: btn.dataset.channelTypeCode || "",
              serviceCode: btn.dataset.serviceCode || "",
              serviceCategoryCode: btn.dataset.serviceCategoryCode || "",
              serviceProviderCode: btn.dataset.serviceProviderCode || "",
              updatedAt: btn.dataset.updatedAt || new Date().toISOString(), // Update timestamp
              updatedBy: btn.dataset.updatedBy
                ? parseInt(btn.dataset.updatedBy)
                : 0,
            };
            console.log("Update client payload:", payload);
            try {
              const response = await fetch(
                `http://45.91.171.213:9080/api/manage/entities/${payload.id}/update/service`,
                {
                  method: "PUT",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: `Bearer ${token}`,
                  },
                  body: JSON.stringify(payload),
                }
              );
              const responseText = await response.text();
              console.log("Update client response status:", response.status);
              console.log("Update client response body:", responseText);
              if (!response.ok)
                throw new Error(responseText || "Failed to update client");
              hideModal("updateClientModal");
              showSuccess("Client updated successfully!");
              fetchClientManagementData();
            } catch (error) {
              console.error("Update error:", error);
              showError(error.message);
            }
          });

        document
          .getElementById("confirmDeleteClientBtn")
          ?.addEventListener("click", async () => {
            const id = document.getElementById("deleteClientId").value;
            try {
              const response = await fetch(
                `http://45.91.171.213:9080/api/manage/entities/${id}/service?serviceId=${id}`,
                {
                  method: "DELETE",
                  headers: { Authorization: `Bearer ${token}` },
                }
              );
              const responseText = await response.text();
              console.log("Delete client response:", responseText);
              if (!response.ok)
                throw new Error(responseText || "Failed to delete client");
              hideModal("deleteClientModal");
              showSuccess("Client deleted successfully!");
              fetchClientManagementData();
            } catch (error) {
              showError(error.message);
            }
          });
      }

      async function fetchClientManagementData() {
        const list = document.getElementById("clientManagementList");
        list.innerHTML = "<p>Loading...</p>";

        try {
          const response = await fetch(
            "http://45.91.171.213:9080/api/manage/entities/all",
            {
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${token}`,
              },
            }
          );
          const responseText = await response.text();
          console.log("Clients API raw response:", responseText);
          if (!response.ok)
            throw new Error(
              `HTTP error! status: ${response.status} - ${responseText}`
            );
          const data = JSON.parse(responseText);
          console.log("Clients API parsed data:", data);

          if (!data.data || data.data.length === 0) {
            list.innerHTML = "<p>No clients found.</p>";
          } else {
            list.innerHTML = `
        <table class="min-w-full bg-white rounded-md shadow-md">
          <thead>
            <tr class="bg-gray-200 text-gray-700">
              <th class="px-6 py-3 text-left">Name</th>
              <th class="px-6 py-3 text-left">Description</th>
              <th class="px-6 py-3 text-left">Country</th>
              <th class="px-6 py-3 text-left">Status</th>
              <th class="px-6 py-3 text-left">Actions</th>
            </tr>
          </thead>
          <tbody>
            ${data.data
              .map(
                (client) => `
                <tr class="border-b">
                  <td class="px-6 py-4 whitespace-nowrap">${
                    client.name || "N/A"
                  }</td>
                  <td class="px-6 py-4">${client.description || "N/A"}</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    client.country || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap">${
                    client.status || "N/A"
                  }</td>
                  <td class="px-6 py-4 whitespace-nowrap relative">
                    <button class="actionBtn">
                      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4z" />
                      </svg>
                    </button>
                    <div class="dropdown-menu" id="dropdown-${client.id}">
                      <button class="updateClientBtn" 
                        data-id="${client.id}" 
                        data-name="${client.name || ""}" 
                        data-description="${client.description || ""}"
                        data-country="${client.country || ""}" 
                        data-status="${client.status || ""}"
                        data-service-type="${client.serviceType || ""}"
                        data-create-at="${client.createAt || ""}"
                        data-created-by="${client.createdBy || ""}"
                        data-channel-type-code="${client.channelTypeCode || ""}"
                        data-service-code="${client.serviceCode || ""}"
                        data-service-category-code="${
                          client.serviceCategoryCode || ""
                        }"
                        data-service-provider-code="${
                          client.serviceProviderCode || ""
                        }"
                        data-updated-at="${client.updatedAt || ""}"
                        data-updated-by="${
                          client.updatedBy || ""
                        }">Update</button>
                      <button class="deleteClientBtn" data-id="${
                        client.id
                      }">Delete</button>
                    </div>
                  </td>
                </tr>
              `
              )
              .join("")}
          </tbody>
        </table>
      `;

            // Attach event listeners for action buttons
            attachClientManagementEventListeners();
          }
        } catch (error) {
          console.error("Fetch error details:", error);
          showError(error.message);
          list.innerHTML =
            "<p>Failed to load clients. Check console for details.</p>";
        }
      }

      function attachClientManagementEventListeners() {
        document.querySelectorAll(".actionBtn").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            e.stopPropagation();
            const dropdown = btn.nextElementSibling;
            const isVisible = dropdown.style.display === "block";

            // Close all other dropdowns
            document.querySelectorAll(".dropdown-menu").forEach((d) => {
              d.style.display = "none";
            });

            // Toggle current dropdown
            if (!isVisible) {
              dropdown.style.display = "block";
              positionDropdown(btn, dropdown); // Use new positioning function
            }
          });
        });

        // Update Client Button
        document.querySelectorAll(".updateClientBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.getElementById("updateClientId").value = btn.dataset.id;
            document.getElementById("updateClientName").value =
              btn.dataset.name;
            document.getElementById("updateClientDescription").value =
              btn.dataset.description;
            document.getElementById("updateClientCountry").value =
              btn.dataset.country;
            document.getElementById("updateClientStatus").value =
              btn.dataset.status;
            showModal("updateClientModal");
          });
        });

        // Delete Client Button
        document.querySelectorAll(".deleteClientBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            document.getElementById("deleteClientId").value = btn.dataset.id;
            showModal("deleteClientModal");
          });
        });

        // Close dropdowns on outside click
        document.addEventListener("click", (e) => {
          if (!e.target.closest(".actionBtn")) {
            document.querySelectorAll(".dropdown-menu").forEach((dropdown) => {
              dropdown.style.display = "none";
            });
          }
        });
      }

      // Product Management Section
      function setupProductManagement() {
        const dropdown = document.getElementById("productManagementDropdown");
        const addBtn = document.getElementById("addServiceBtn");

        if (dropdown) {
          dropdown.addEventListener("change", fetchProductManagementData);
        }
        if (addBtn) {
          addBtn.addEventListener("click", () => {
            showModal("addServiceModal");
          });
        }
      }

      async function fetchProductManagementData() {
        const list = document.getElementById("productManagementList");
        list.innerHTML = "<p>Loading...</p>";

        try {
          const response = await fetch(
            "http://45.91.171.213:9080/api/manage/services/all",
            {
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${token}`,
              },
            }
          );
          if (!response.ok) {
            const errorText = await response.text();
            throw new Error(
              `HTTP error! status: ${response.status} - ${errorText}`
            );
          }
          const data = await response.json();
          console.log("Product Management API response:", data);

          if (!data.data || data.data.length === 0) {
            list.innerHTML = "<p>No services found.</p>";
          } else {
            list.innerHTML = `
        <div class="table-container">
          <table class="min-w-full bg-white rounded-md shadow-md">
            <thead>
              <tr class="bg-gray-200 text-gray-700">
                <th class="px-6 py-3 text-left">Service Name</th>
                <th class="px-6 py-3 text-left">Description</th>
                <th class="px-6 py-3 text-left">Service Type</th>
                <th class="px-6 py-3 text-left">Actions</th>
              </tr>
            </thead>
            <tbody>
              ${data.data
                .map(
                  (service) => `
                    <tr class="border-b">
                      <td class="px-6 py-4 whitespace-nowrap">${
                        service.name || "N/A"
                      }</td>
                      <td class="px-6 py-4 whitespace-nowrap">${
                        service.description || "N/A"
                      }</td>
                      <td class="px-6 py-4 whitespace-nowrap">${
                        service.serviceType || "N/A"
                      }</td>
                      <td class="px-6 py-4 whitespace-nowrap relative">
                        <button class="actionBtn text-gray-600 hover:text-gray-800" data-service='${JSON.stringify(
                          service
                        )}'>
                          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4z" />
                          </svg>
                        </button>
                        <div class="dropdown-menu" id="dropdown-${service.id}">
                          <button class="updateServiceBtn" data-service='${JSON.stringify(
                            service
                          )}'>Update</button>
                          <button class="deleteServiceBtn" data-id="${
                            service.id
                          }">Delete</button>
                        </div>
                      </td>
                    </tr>
                  `
                )
                .join("")}
            </tbody>
          </table>
        </div>
      `;

            // Attach event listeners for action buttons
            document.querySelectorAll(".actionBtn").forEach((btn) => {
              btn.addEventListener("click", (e) => {
                e.stopPropagation();
                const dropdown = btn.nextElementSibling;
                const isVisible = dropdown.style.display === "block";

                // Close all other dropdowns
                document.querySelectorAll(".dropdown-menu").forEach((menu) => {
                  if (menu !== dropdown) {
                    menu.style.display = "none";
                  }
                });

                // Toggle current dropdown
                if (!isVisible) {
                  dropdown.style.display = "block";
                  positionDropdown(btn, dropdown); // Position the dropdown correctly
                } else {
                  dropdown.style.display = "none";
                }
              });
            });

            // Update Service Button
            document.querySelectorAll(".updateServiceBtn").forEach((btn) => {
              btn.addEventListener("click", () => {
                const service = JSON.parse(btn.dataset.service);
                document.getElementById("updateServiceId").value = service.id;
                document.getElementById("updateServiceName").value =
                  service.name || "";
                document.getElementById("updateServiceDescription").value =
                  service.description || "";
                document.getElementById("updateServiceType").value =
                  service.serviceType || "";
                showModal("updateServiceModal");
              });
            });

            // Delete Service Button
            document.querySelectorAll(".deleteServiceBtn").forEach((btn) => {
              btn.addEventListener("click", () => {
                document.getElementById("deleteServiceId").value =
                  btn.dataset.id;
                showModal("deleteServiceModal");
              });
            });
          }
        } catch (error) {
          console.error("Fetch error details:", error);
          showError(error.message);
          list.innerHTML =
            "<p>Failed to load services. Check console for details.</p>";
        }
      }

      // User Management Section
      function setupUserManagement() {
        const dropdown = document.getElementById("userManagementDropdown");
        const addBtn = document.getElementById("addUserBtn");

        if (dropdown)
          dropdown.addEventListener("change", fetchUserManagementData);
        if (addBtn)
          addBtn.addEventListener("click", () => showModal("addUserModal"));
      }

      async function fetchUserManagementData() {
        const list = document.getElementById("userManagementList");
        list.innerHTML = "<p>Loading...</p>";

        try {
          const url = "http://45.91.171.213:9080/api/manage/users/application"; // Confirmed GET endpoint
          const response = await fetch(url, {
            headers: { Authorization: `Bearer ${token}` },
          });
          const responseText = await response.text();
          if (!response.ok) {
            console.error("Fetch users error:", response.status, responseText);
            throw new Error(
              `HTTP error! status: ${response.status} - ${
                responseText || "Unknown error"
              }`
            );
          }

          const data = JSON.parse(responseText);
          console.log("Users API raw response:", responseText);
          console.log("Users API parsed data:", data);

          list.innerHTML =
            data.data
              ?.map(
                (user) => `
      <div class="bg-white p-4 rounded-md shadow-md flex justify-between items-center">
        <div>
          <p>ID: ${user.id || "N/A"}</p>
          <p>Email: ${user.emailAddress || "N/A"}</p>
          <p>Name: ${user.userName || "N/A"}</p>
          <p>Type: ${user.descriminator || "N/A"}</p>
          <p>Status: ${user.accountStatus || "N/A"} ${
                  user.isLockedOut ? "(Locked)" : ""
                }</p>
          <p>Phone: ${user.phoneNumber || "N/A"}</p>
        </div>
        <div class="space-x-2">
          <button class="updateUserBtn bg-yellow-500 px-2 py-1 rounded-md text-white" 
            data-id="${user.id}" 
            data-email="${user.emailAddress || ""}" 
            data-username="${user.userName || ""}" 
            data-type="${user.descriminator || ""}"
            data-status="${user.accountStatus || ""}">Update</button>
        </div>
      </div>
    `
              )
              .join("") || "<p>No users found.</p>";

          document.querySelectorAll(".updateUserBtn").forEach((btn) => {
            btn.addEventListener("click", () => {
              document.getElementById("updateUserId").value = btn.dataset.id;
              document.getElementById("updateUserEmailAddress").value =
                btn.dataset.email;
              document.getElementById("updateUserFullName").value =
                btn.dataset.username;
              document.getElementById("updateUserRole").value =
                btn.dataset.type;
              document.getElementById("updateUserAction").value =
                btn.dataset.status === "Active" ? "ACTIVATE" : "DEACTIVATE";
              showModal("updateUserModal");
            });
          });
        } catch (error) {
          showError(error.message);
          list.innerHTML =
            "<p>Unable to load users. Check permissions or try again later.</p>";
          console.error("Fetch error details:", error);
        }
      }

      // New function for Countries Management setup
      function setupCountriesManagement() {
        const addBtn = document.getElementById("addCountryBtn");
        if (addBtn) {
          addBtn.addEventListener("click", () => {
            showModal("addCountryModal");
          });
        }
      }

     // fetchCountriesManagementData updated
      async function fetchCountriesManagementData() {
        const list = document.getElementById("countriesManagementList");
        list.innerHTML = "<p>Loading...</p>";

        try {
          const response = await fetch(
            "http://45.91.171.213:9080/api/manage/service/countries/all",
            {
              headers: {
                Authorization: `Bearer ${token}`
              }
            }
          );
          const responseText = await response.text();
          console.log("Countries API response:", responseText);
          if (!response.ok) {
            throw new Error(`Failed to fetch countries: ${responseText || response.status}`);
          }
          const data = JSON.parse(responseText);
          console.log("Countries parsed data:", data);

          if (!data.data || data.data.length === 0) {
            list.innerHTML = "<p>No countries found.</p>";
          } else {
            list.innerHTML = `
              <div class="overflow-x-auto relative">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Country Name</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Country Code</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ISO Code</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Dial Code</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Currency</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Currency Symbol</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mobile Length</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Bill Payment</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Offline Payment</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    ${data.data.map(country => `
                      <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.countryName || "N/A"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.countryCode || "N/A"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.countryIsoCode || "N/A"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.dialCode || "N/A"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.currencyCode || "N/A"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.currencySymbol || "N/A"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.mobileLength || "N/A"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.billPaymentSupported ? "Yes" : "No"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.offlinePaymentSupported ? "Yes" : "No"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${country.status || "N/A"}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 relative">
                          <button class="actionBtn" data-id="${country.id}">
                            <svg class="w-5 h-5 text-gray-400 hover:text-gray-600" fill="currentColor" viewBox="0 0 20 20">
                              <path d="M10 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4z" />
                            </svg>
                          </button>
                          <div class="dropdown-menu hidden absolute bg-white shadow-lg rounded-md py-1 mt-1 border border-blue-500" id="dropdown-${country.id}">
                            <button class="updateCountryBtn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" 
                              data-id="${country.id}"
                              data-country-name="${country.countryName || ""}"
                              data-country-code="${country.countryCode || ""}"
                              data-iso-code="${country.countryIsoCode || ""}"
                              data-dial-code="${country.dialCode || ""}"
                              data-currency-code="${country.currencyCode || ""}"
                              data-currency-symbol="${country.currencySymbol || ""}"
                              data-mobile-length="${country.mobileLength || ""}"
                              data-bill-payment="${country.billPaymentSupported || false}"
                              data-offline-payment="${country.offlinePaymentSupported || false}"
                              data-status="${country.status || ""}">
                              Update
                            </button>
                            <button class="deleteCountryBtn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" 
                              data-id="${country.id}">
                              Delete
                            </button>
                          </div>
                        </td>
                      </tr>
                    `).join("")}
                  </tbody>
                </table>
              </div>
            `;
            attachCountriesManagementEventListeners();
          }
        } catch (error) {
          console.error("Fetch countries error:", error);
          showError(error.message);
          list.innerHTML = "<p>Failed to load countries.</p>";
        }
      }

      // attachCountriesManagementEventListeners updated
      function attachCountriesManagementEventListeners() {
        const actionButtons = document.querySelectorAll(".actionBtn");
        console.log("Action buttons found:", actionButtons.length);
        
        actionButtons.forEach(btn => {
          btn.removeEventListener("click", handleActionClick);
          btn.addEventListener("click", handleActionClick);
        });

        function handleActionClick(e) {
          e.stopPropagation();
          const dropdown = e.currentTarget.nextElementSibling;
          console.log("Action button clicked, dropdown:", dropdown);
          
          const isVisible = !dropdown.classList.contains("hidden");
          document.querySelectorAll(".dropdown-menu").forEach(d => {
            d.classList.add("hidden");
            d.style.display = "none";
            d.style.zIndex = "";
          });

          if (!isVisible) {
            dropdown.classList.remove("hidden");
            dropdown.style.display = "block";
            dropdown.style.zIndex = "300";
            positionDropdown(e.currentTarget, dropdown);
            console.log("Dropdown shown:", 
              "display:", dropdown.style.display, 
              "zIndex:", dropdown.style.zIndex, 
              "top:", dropdown.style.top, 
              "left:", dropdown.style.left,
              "computed display:", getComputedStyle(dropdown).display
            );
          }
        }

        document.querySelectorAll(".updateCountryBtn").forEach(btn => {
          btn.addEventListener("click", () => {
            console.log("Update button clicked, id:", btn.dataset.id);
            document.getElementById("updateCountryId").value = btn.dataset.id;
            document.getElementById("updateCountryName").value = btn.dataset.countryName;
            document.getElementById("updateCountryCode").value = btn.dataset.countryCode;
            document.getElementById("updateCountryIsoCode").value = btn.dataset.isoCode;
            document.getElementById("updateDialCode").value = btn.dataset.dialCode;
            document.getElementById("updateCurrencyCode").value = btn.dataset.currencyCode;
            document.getElementById("updateCurrencySymbol").value = btn.dataset.currencySymbol;
            document.getElementById("updateMobileLength").value = btn.dataset.mobileLength;
            document.getElementById("updateBillPaymentSupported").checked = btn.dataset.billPayment === "true";
            document.getElementById("updateOfflinePaymentSupported").checked = btn.dataset.offlinePayment === "true";
            document.getElementById("updateCountryStatus").value = btn.dataset.status;
            showModal("updateCountryModal");
          });
        });

        document.querySelectorAll(".deleteCountryBtn").forEach(btn => {
          btn.addEventListener("click", () => {
            console.log("Delete button clicked, id:", btn.dataset.id);
            document.getElementById("deleteCountryId").value = btn.dataset.id;
            showModal("deleteCountryModal");
          });
        });

        document.addEventListener("click", (e) => {
          if (!e.target.closest(".actionBtn")) {
            document.querySelectorAll(".dropdown-menu").forEach(dropdown => {
              dropdown.classList.add("hidden");
              dropdown.style.display = "none";
              dropdown.style.zIndex = "";
            });
          }
        });
      }

      

      // Form Submissions
      function setupForms() {
        // Add Provider
        document
          .getElementById("addProviderForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();

            const providerNameInput =
              document.getElementById("addProviderName");
            const imageUrlInput = document.getElementById("providerImage");
            const serviceTypeInput = document.getElementById("serviceType");

            console.log("addProviderName element:", providerNameInput);
            console.log("providerImage element:", imageUrlInput);
            console.log("serviceType element:", serviceTypeInput);

            if (!providerNameInput || !imageUrlInput || !serviceTypeInput) {
              showError("Form error: Input fields not found");
              return;
            }

            const providerName = providerNameInput.value.trim();
            const imageUrl = imageUrlInput.value.trim();
            const serviceType = serviceTypeInput.value;

            if (!providerName) {
              showError("Provider Name is required");
              return;
            }
            if (
              !serviceType ||
              !["BillsPayment", "Remit"].includes(serviceType)
            ) {
              showError(
                "Please select a valid Service Type (BillsPayment or Remit)"
              );
              return;
            }

            const payload = {
              providerName: providerName,
              imageUrl: imageUrl || null,
              serviceType: serviceType,
            };

            console.log(
              "Submitting provider payload:",
              JSON.stringify(payload, null, 2)
            );
            alert("Submitting provider: " + JSON.stringify(payload, null, 2));

            try {
              const response = await fetch(
                "http://45.91.171.213:9080/api/manage/bills-payment/providers/add",
                {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: `Bearer ${token}`,
                  },
                  body: JSON.stringify(payload),
                }
              );

              const responseText = await response.text();
              console.log("Add provider response:", responseText);

              if (!response.ok) {
                const errorMsg = `Failed to add provider: ${
                  responseText || response.status
                }`;
                alert(errorMsg);
                throw new Error(errorMsg);
              }

              alert("Provider added successfully!");
              console.log("Provider added successfully");
              showSuccess("Provider added successfully!");
              hideModal("addProviderModal");
              document.getElementById("addProviderForm").reset();
              fetchBillsPaymentData();
            } catch (error) {
              const errorMsg = `Error adding provider: ${error.message}`;
              alert(errorMsg);
              console.error(errorMsg, error);
              showError(errorMsg);
            }
          });

        // Add Category
        document
          .getElementById("addCategoryForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const payload = {
              name: document.getElementById("categoryName").value,
              description: document.getElementById("categoryDescription").value,
              customerValidationRequired: document.getElementById(
                "customerValidationRequired"
              ).checked,
            };
            await submitForm(
              "http://45.91.171.213:9080/api/manage/bills-payment/add/category",
              payload,
              "addCategoryModal",
              fetchBillsPaymentData,
              "Category"
            );
          });

        // Update Category
        document
          .getElementById("updateCategoryForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const payload = {
              id: document.getElementById("updateCategoryId").value,
              name: document.getElementById("updateCategoryName").value,
              description: document.getElementById("updateCategoryDescription")
                .value,
              customerValidationRequired: document.getElementById(
                "updateCustomerValidationRequired"
              ).checked,
            };
            await submitForm(
              "http://45.91.171.213:9080/api/manage/bills-payment/category/update",
              payload,
              "updateCategoryModal",
              fetchBillsPaymentData,
              "Category",
              "updated"
            );
          });

        // Add Biller
        document
          .getElementById("addBillerForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const payload = {
              serviceId: document.getElementById("billerServiceId").value,
              providerId: parseInt(
                document.getElementById("billerProviderId").value
              ),
              operatorId: document.getElementById("billerOperatorId").value,
              name: document.getElementById("billerName").value,
              categoryId: parseInt(
                document.getElementById("billerCategoryId").value
              ),
              itemType: document.getElementById("billerItemType").value,
              description: document.getElementById("billerDescription").value,
              countryId: parseInt(
                document.getElementById("billerCountryId").value
              ),
              minAmount: document.getElementById("billerMinAmount").value,
              maxAmount: document.getElementById("billerMaxAmount").value,
            };
            console.log(
              "Payload being sent to /add/biller:",
              JSON.stringify(payload, null, 2)
            );
            await submitForm(
              "http://45.91.171.213:9080/api/manage/bills-payment/add/biller",
              payload,
              "addBillerModal",
              fetchBillsPaymentData,
              "Biller"
            );
          });

        // Update Biller
        document
          .getElementById("updateBillerForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const payload = {
              id: document.getElementById("updateBillerId").value,
              serviceId: document.getElementById("updateBillerServiceId").value,
              providerId: parseInt(
                document.getElementById("updateBillerProviderId").value
              ),
              operatorId: document.getElementById("updateBillerOperatorId")
                .value,
              name: document.getElementById("updateBillerName").value,
              categoryId: parseInt(
                document.getElementById("updateBillerCategoryId").value
              ),
              itemType: document.getElementById("updateBillerItemType").value,
              description: document.getElementById("updateBillerDescription")
                .value,
              countryId: parseInt(
                document.getElementById("updateBillerCountryId").value
              ),
              minAmount: document.getElementById("updateBillerMinAmount").value,
              maxAmount: document.getElementById("updateBillerMaxAmount").value,
            };
            await submitForm(
              "http://45.91.171.213:9080/api/manage/bills-payment/biller/update",
              payload,
              "updateBillerModal",
              fetchBillsPaymentData,
              "Biller",
              "updated"
            );
          });

        // Add Client
        document
          .getElementById("addClientForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const entityId = document.getElementById("clientEntityId").value;
            const payload = {
              applicationId: parseInt(
                document.getElementById("clientApplicationId").value
              ),
              status: document.getElementById("clientStatus").value,
            };
            try {
              const response = await fetch(
                `http://45.91.171.213:9080/api/manage/entities/${entityId}/service/add`,
                {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: `Bearer ${token}`,
                  },
                  body: JSON.stringify(payload),
                }
              );
              const responseText = await response.text();
              if (!response.ok) {
                console.error(
                  "Add client service error:",
                  response.status,
                  responseText
                );
                throw new Error(responseText || "Failed to add client service");
              }
              console.log("Add client service success:", responseText);
              hideModal("addClientModal");
              showSuccess("Client service added successfully!");
              fetchClientManagementData();
            } catch (error) {
              showError(error.message);
            }
          });

        document
          .getElementById("updateClientForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const payload = {
              id: parseInt(document.getElementById("updateClientId").value),
              name: document.getElementById("updateClientName").value,
              description: document.getElementById("updateClientDescription")
                .value,
              country:
                document.getElementById("updateClientCountry").value || null,
              status: document.getElementById("updateClientStatus").value,
            };
            console.log("Update client payload:", payload);
            try {
              const response = await fetch(
                `http://45.91.171.213:9080/api/manage/entities/${payload.id}/update/service`,
                {
                  method: "PUT",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: `Bearer ${token}`,
                  },
                  body: JSON.stringify(payload),
                }
              );
              const responseText = await response.text();
              console.log("Update client response status:", response.status);
              console.log("Update client response headers:", [
                ...response.headers,
              ]);
              console.log("Update client response body:", responseText);
              if (!response.ok)
                throw new Error(responseText || "Failed to update client");
              hideModal("updateClientModal");
              showSuccess("Client updated successfully!");
              fetchClientManagementData(); // Refresh the list
            } catch (error) {
              console.error("Update error:", error);
              showError(error.message);
            }
          });

        // Add Service
        document
          .getElementById("addServiceForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const payload = {
              name: document.getElementById("serviceName").value,
              description: document.getElementById("serviceDescription").value,
              serviceType: document.getElementById("serviceType").value,
              channelTypeCode: document.getElementById("channelTypeCode").value,
              serviceCode: document.getElementById("serviceCode").value,
              serviceCategoryCode: document.getElementById(
                "serviceCategoryCode"
              ).value,
              serviceProviderCode: document.getElementById(
                "serviceProviderCode"
              ).value,
              countryCode: document.getElementById("countryCode").value,
            };
            await submitForm(
              "http://45.91.171.213:9080/api/manage/services/create",
              payload,
              "addServiceModal",
              fetchProductManagementData,
              "Service"
            );
          });

        document
          .getElementById("updateServiceForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const payload = {
              id: parseInt(document.getElementById("updateServiceId").value),
              name: document.getElementById("updateServiceName").value,
              description: document.getElementById("updateServiceDescription")
                .value,
              serviceType: document.getElementById("updateServiceType").value,
              channelTypeCode: document.getElementById("updateChannelTypeCode")
                .value,
              serviceCode: document.getElementById("updateServiceCode").value,
              serviceCategoryCode: document.getElementById(
                "updateServiceCategoryCode"
              ).value,
              serviceProviderCode: document.getElementById(
                "updateServiceProviderCode"
              ).value,
              countryCode: document.getElementById("updateCountryCode").value,
            };
            await submitForm(
              "http://45.91.171.213:9080/api/manage/services/update",
              payload,
              "updateServiceModal",
              fetchProductManagementData,
              "Service",
              "updated",
              "PUT"
            );
          });

        // Add User
        document
          .getElementById("addUserForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const roleValue = document.getElementById("userRole").value;
            const payload = {
              emailAddress: document.getElementById("userEmailAddress").value,
              phoneNumber: document.getElementById("userPhoneNumber").value,
              firstName: document.getElementById("userFirstName").value,
              lastName: document.getElementById("userLastName").value,
              address: document.getElementById("userAddress").value,
              city: document.getElementById("userCity").value || undefined,
              state: document.getElementById("userState").value || undefined,
              country:
                document.getElementById("userCountry").value || undefined,
              role: roleValue
                ? {
                    roleName: roleValue,
                    roleDescription:
                      roleValue === "ROLE_ADMIN" ? "Admin role" : "User role",
                    permissions: ["READ"], // Adjust based on backend requirements
                  }
                : undefined,
            };
            try {
              const response = await fetch(
                "http://45.91.171.213:9080/api/manage/users/create",
                {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                    Authorization: `Bearer ${token}`,
                  },
                  body: JSON.stringify(payload),
                }
              );
              const responseText = await response.text();
              if (!response.ok) {
                console.error(
                  "Create user error:",
                  response.status,
                  responseText
                );
                throw new Error(responseText || "Failed to add user");
              }
              console.log("Create user success:", responseText);
              hideModal("addUserModal");
              showSuccess("User added successfully!");
              fetchUserManagementData();
            } catch (error) {
              showError(error.message);
            }
          });

        // Update User
        document
          .getElementById("updateUserForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const roleName = document.getElementById("updateUserRole").value;
            const payload = {
              action: document.getElementById("updateUserAction").value,
              userId: parseInt(document.getElementById("updateUserId").value),
              role: {
                roleName: roleName,
                roleDescription:
                  roleName === "ROLE_ADMIN" ? "Admin role" : "User role",
                permissions: ["READ"], // Static, adjust if needed
              },
            };
            await submitForm(
              "http://45.91.171.213:9080/api/manage/users/update-status",
              payload,
              "updateUserModal",
              fetchUserManagementData,
              "User",
              "updated",
              "PUT"
            );
          });

        // Add Country Form
        document
          .getElementById("addCountryForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const payload = {
              countryName: document.getElementById("countryName").value.trim(),
              countryCode: document.getElementById("countryCode").value.trim(),
              countryIsoCode: document
                .getElementById("countryIsoCode")
                .value.trim(),
              dialCode: document.getElementById("dialCode").value.trim(),
              currencyCode: document
                .getElementById("currencyCode")
                .value.trim(),
              currencySymbol: document
                .getElementById("currencySymbol")
                .value.trim(),
              mobileLength:
                document.getElementById("mobileLength").value.trim() || null,
              billPaymentSupported: document.getElementById(
                "billPaymentSupported"
              ).checked,
              offlinePaymentSupported: document.getElementById(
                "offlinePaymentSupported"
              ).checked,
              status:
                document.getElementById("countryStatus").value || "Active",
            };
            console.log("Submitting add country payload:", payload);
            await submitForm(
              "http://45.91.171.213:9080/api/manage/service/countries/create",
              payload,
              "addCountryModal",
              fetchCountriesManagementData,
              "Country"
            );
          });

        // Update Country Form
        document
          .getElementById("updateCountryForm")
          ?.addEventListener("submit", async (e) => {
            e.preventDefault();
            const payload = {
              id: parseInt(document.getElementById("updateCountryId").value),
              countryName: document
                .getElementById("updateCountryName")
                .value.trim(),
              countryCode: document
                .getElementById("updateCountryCode")
                .value.trim(),
              countryIsoCode: document
                .getElementById("updateCountryIsoCode")
                .value.trim(),
              dialCode: document.getElementById("updateDialCode").value.trim(),
              currencyCode: document
                .getElementById("updateCurrencyCode")
                .value.trim(),
              currencySymbol: document
                .getElementById("updateCurrencySymbol")
                .value.trim(),
              mobileLength:
                document.getElementById("updateMobileLength").value.trim() ||
                null,
              billPaymentSupported: document.getElementById(
                "updateBillPaymentSupported"
              ).checked,
              offlinePaymentSupported: document.getElementById(
                "updateOfflinePaymentSupported"
              ).checked,
              status: document.getElementById("updateCountryStatus").value,
            };
            console.log("Submitting update country payload:", payload);
            await submitForm(
              "http://45.91.171.213:9080/api/manage/service/countries/update",
              payload,
              "updateCountryModal",
              fetchCountriesManagementData,
              "Country",
              "updated",
              "PUT"
            );
          });

        // Delete Country Confirmation
        document
          .getElementById("confirmDeleteCountryBtn")
          ?.addEventListener("click", async () => {
            const id = document.getElementById("deleteCountryId").value;
            try {
              const response = await fetch(
                `http://45.91.171.213:9080/api/manage/service/countries/${id}`,
                {
                  method: "DELETE",
                  headers: { Authorization: `Bearer ${token}` },
                }
              );
              const responseText = await response.text();
              console.log("Delete country response:", responseText);
              if (!response.ok) {
                throw new Error(responseText || "Failed to delete country");
              }
              hideModal("deleteCountryModal");
              showSuccess("Country deleted successfully!");
              fetchCountriesManagementData();
            } catch (error) {
              console.error("Delete country error:", error);
              showError(error.message);
            }
          });
      }

      async function submitForm(
        url,
        payload,
        modalId,
        refreshFn,
        entityName,
        action = "added",
        method = "POST"
      ) {
        try {
          const response = await fetch(url, {
            method: method,
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${token}`,
            },
            body: JSON.stringify(payload),
          });
          if (!response.ok)
            throw new Error(
              (await response.text()) ||
                `Failed to ${action} ${entityName.toLowerCase()}`
            );
          hideModal(modalId);
          showSuccess(`${entityName} ${action} successfully!`);
          refreshFn();
        } catch (error) {
          showError(error.message);
        }
      }

      // Delete Operations
      async function deleteItem(type, id, serviceId = null) {
        if (!confirm(`Are you sure you want to delete this ${type}?`)) return;
        const url =
          type === "category"
            ? `http://45.91.171.213:9080/api/manage/bills-payment/category/${id}`
            : `http://45.91.171.213:9080/api/manage/bills-payment/biller/${id}/${serviceId}`;
        try {
          const response = await fetch(url, {
            method: "DELETE",
            headers: { Authorization: `Bearer ${token}` },
          });
          if (!response.ok)
            throw new Error(
              (await response.text()) || `Failed to delete ${type}`
            );
          showSuccess(
            `${
              type.charAt(0).toUpperCase() + type.slice(1)
            } deleted successfully!`
          );
          fetchBillsPaymentData();
        } catch (error) {
          showError(error.message);
        }
      }

      async function deleteClient(id, serviceId) {
        if (!confirm("Are you sure you want to delete this client?")) return;
        try {
          if (!serviceId)
            throw new Error("Service ID is required for deletion");
          const url = `http://45.91.171.213:9080/api/manage/entities/${id}/service/${serviceId}`;
          const response = await fetch(url, {
            method: "DELETE",
            headers: { Authorization: `Bearer ${token}` },
          });
          if (!response.ok)
            throw new Error(
              (await response.text()) || "Failed to delete client"
            );
          showSuccess("Client deleted successfully!");
          fetchClientManagementData();
        } catch (error) {
          showError(error.message);
        }
      }

      async function deleteService(id) {
        if (!confirm("Are you sure you want to delete this service?")) return;
        try {
          const response = await fetch(
            `http://45.91.171.213:9080/api/manage/services/${id}`,
            {
              method: "DELETE",
              headers: { Authorization: `Bearer ${token}` },
            }
          );
          if (!response.ok)
            throw new Error(
              (await response.text()) || "Failed to delete service"
            );
          showSuccess("Service deleted successfully!");
          fetchProductManagementData();
        } catch (error) {
          showError(error.message);
        }
      }

      // Populate Biller Dropdowns
      async function populateBillerDropdowns() {
        // Provider ID
        try {
          const response = await fetch(
            "http://45.91.171.213:9080/api/manage/bills-payment/providers",
            {
              headers: { Authorization: `Bearer ${token}` },
            }
          );
          if (!response.ok) throw new Error("Failed to fetch providers");
          const data = await response.json();
          ["billerProviderId", "updateBillerProviderId"].forEach((id) => {
            const select = document.getElementById(id);
            select.innerHTML =
              '<option value="" disabled selected>Select a provider</option>';
            data.data?.forEach((provider) => {
              const option = document.createElement("option");
              option.value = provider.id;
              option.textContent = provider.providerName;
              select.appendChild(option);
            });
          });
        } catch (error) {
          console.error("Error fetching providers:", error);
          showError("Failed to load providers");
        }

        // Category ID
        try {
          const response = await fetch(
            "http://45.91.171.213:9080/api/manage/bills-payment/categories",
            {
              headers: { Authorization: `Bearer ${token}` },
            }
          );
          if (!response.ok) throw new Error("Failed to fetch categories");
          const data = await response.json();
          ["billerCategoryId", "updateBillerCategoryId"].forEach((id) => {
            const select = document.getElementById(id);
            select.innerHTML =
              '<option value="" disabled selected>Select a category</option>';
            data.data?.forEach((category) => {
              const option = document.createElement("option");
              option.value = category.id;
              option.textContent = category.name;
              select.appendChild(option);
            });
          });
        } catch (error) {
          console.error("Error fetching categories:", error);
          showError("Failed to load categories");
        }

        // Item Type (Static)
        const itemTypes = ["ProviderBaseBouquet", "Regular"]; // Updated to match schema
        ["billerItemType", "updateBillerItemType"].forEach((id) => {
          const select = document.getElementById(id);
          select.innerHTML =
            '<option value="" disabled selected>Select an item type</option>';
          itemTypes.forEach((type) => {
            const option = document.createElement("option");
            option.value = type;
            option.textContent = type;
            select.appendChild(option);
          });
        });

        // Country ID (Static until endpoint provided)
        const countries = [
          { id: 1, name: "Nigeria" },
          { id: 2, name: "Ghana" },
        ];
        ["billerCountryId", "updateBillerCountryId"].forEach((id) => {
          const select = document.getElementById(id);
          select.innerHTML =
            '<option value="" disabled selected>Select a country</option>';
          countries.forEach((country) => {
            const option = document.createElement("option");
            option.value = country.id;
            option.textContent = country.name;
            select.appendChild(option);
          });
        });

        // Operator ID (Static)
        ["billerOperatorId", "updateBillerOperatorId"].forEach((id) => {
          const select = document.getElementById(id);
          select.innerHTML = `
      <option value="" disabled selected>Select an operator</option>
      <option value="OP1">Operator 1</option>
      <option value="OP2">Operator 2</option>
    `;
        });
      }

      // Transaction Completion Functions
      function showCompleteTransactionModal(transaction) {
        const detailsDiv = document.getElementById("transactionDetails");
        detailsDiv.innerHTML = `
    <p><strong>Request Reference:</strong> ${
      transaction.requestReference || "N/A"
    }</p>
    <p><strong>Customer Reference:</strong> ${
      transaction.customerReference || "N/A"
    }</p>
    <p><strong>Amount:</strong> ${transaction.amount || "N/A"} ${
          transaction.currency || ""
        }</p>
    <p><strong>Provider:</strong> ${transaction.providerName || "N/A"}</p>
    <p><strong>Created At:</strong> ${
      transaction.createdAt
        ? new Date(transaction.createdAt).toLocaleString()
        : "N/A"
    }</p>
    <p><strong>Status:</strong> ${transaction.status || "N/A"}</p>
  `;
        showModal("completeTransactionModal");

        const approveBtn = document.getElementById("approveTransactionBtn");
        const rejectBtn = document.getElementById("rejectTransactionBtn");
        approveBtn.onclick = () =>
          completeTransaction(transaction, "Completed"); // Mapping to new enum
        rejectBtn.onclick = () => completeTransaction(transaction, "Rejected"); // Mapping to new enum
      }

      async function completeTransaction(transaction, status) {
        try {
          console.log(
            "Transaction object:",
            JSON.stringify(transaction, null, 2)
          );

          const requestId = transaction.id || transaction.requestReference; // Fallback to id if available
          if (!requestId) {
            throw new Error("No valid request ID found in transaction data.");
          }

          const parsedRequestId = parseInt(requestId);
          console.log("Using requestId:", parsedRequestId || requestId);

          const payload = {
            requestId: parsedRequestId || requestId, // Use parsed if numeric, raw if string
            status: status,
            remark: `${status} by admin on ${new Date().toLocaleString()}`,
            userData: transaction.customerReference || null,
            userDataPropertyIdentifier: transaction.token || null,
            additionInstruction:
              status === "Completed"
                ? "Transaction approved successfully."
                : "Transaction rejected. Please contact support if needed.",
            sendEmail: true,
            sendSms: false,
            serviceType: "BillsPayment",
          };

          console.log("Payload:", JSON.stringify(payload, null, 2));

          const response = await fetch(
            "http://45.91.171.213:9080/api/manage/request/completion/update",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${token}`,
              },
              body: JSON.stringify(payload),
            }
          );

          const responseText = await response.text();
          console.log("Response:", responseText);

          if (!response.ok) {
            throw new Error(
              responseText || `Failed to ${status.toLowerCase()} transaction`
            );
          }

          hideModal("completeTransactionModal");
          showSuccess(`Transaction ${status.toLowerCase()} successfully!`);
          fetchBillsPaymentData();
        } catch (error) {
          console.error("Error:", error);
          showError(error.message);
        }
      }

      // Modal Event Listeners
      function setupModalEventListeners() {
        document
          .getElementById("closeSuccessBtn")
          ?.addEventListener("click", () => hideModal("successModal"));
        document
          .getElementById("closeErrorBtn")
          ?.addEventListener("click", () => hideModal("errorModal"));
        document
          .getElementById("cancelAddProviderBtn")
          ?.addEventListener("click", () => hideModal("addProviderModal"));
        document
          .getElementById("cancelAddCategoryBtn")
          ?.addEventListener("click", () => hideModal("addCategoryModal"));
        document
          .getElementById("cancelUpdateCategoryBtn")
          ?.addEventListener("click", () => hideModal("updateCategoryModal"));
        document
          .getElementById("cancelAddBillerBtn")
          ?.addEventListener("click", () => hideModal("addBillerModal"));
        document
          .getElementById("cancelUpdateBillerBtn")
          ?.addEventListener("click", () => hideModal("updateBillerModal"));
        document
          .getElementById("cancelAddClientBtn")
          ?.addEventListener("click", () => hideModal("addClientModal"));
        document
          .getElementById("cancelUpdateClientBtn")
          ?.addEventListener("click", () => hideModal("updateClientModal"));
        document
          .getElementById("cancelAddServiceBtn")
          ?.addEventListener("click", () => hideModal("addServiceModal"));
        document
          .getElementById("cancelUpdateServiceBtn")
          ?.addEventListener("click", () => hideModal("updateServiceModal"));
        document
          .getElementById("cancelCompleteTransactionBtn")
          ?.addEventListener("click", () =>
            hideModal("completeTransactionModal")
          );
        document
          .getElementById("cancelAddUserBtn")
          ?.addEventListener("click", () => hideModal("addUserModal"));
        document
          .getElementById("cancelUpdateUserBtn")
          ?.addEventListener("click", () => hideModal("updateUserModal"));
        document
          .getElementById("cancelAddCountryBtn")
          ?.addEventListener("click", () => hideModal("addCountryModal"));
        document
          .getElementById("cancelUpdateCountryBtn")
          ?.addEventListener("click", () => hideModal("updateCountryModal"));
        document
          .getElementById("cancelDeleteCountryBtn")
          ?.addEventListener("click", () => hideModal("deleteCountryModal"));
      }
    </script>
  </body>
</html>
